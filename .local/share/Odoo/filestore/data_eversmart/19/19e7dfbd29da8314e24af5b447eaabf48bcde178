
/* /website/static/src/js/editor/editor.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.editor',function(require){'use strict';var weWidgets=require('web_editor.widget');var wUtils=require('website.utils');weWidgets.LinkDialog.include({start:async function(){const result=await this._super.apply(this,arguments);wUtils.autocompleteWithPages(this,this.$('input[name="url"]'));return result;},});});;

/* /website/static/src/js/editor/snippets.editor.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.snippet.editor',function(require){'use strict';const{qweb,_t,_lt}=require('web.core');const Dialog=require('web.Dialog');const weSnippetEditor=require('web_editor.snippet.editor');const wSnippetOptions=require('website.editor.snippets.options');const OdooEditorLib=require('@web_editor/../lib/odoo-editor/src/utils/utils');const getDeepRange=OdooEditorLib.getDeepRange;const getTraversedNodes=OdooEditorLib.getTraversedNodes;const FontFamilyPickerUserValueWidget=wSnippetOptions.FontFamilyPickerUserValueWidget;weSnippetEditor.SnippetsMenu.include({xmlDependencies:(weSnippetEditor.SnippetsMenu.prototype.xmlDependencies||[]).concat(['/website/static/src/xml/website.editor.xml']),events:_.extend({},weSnippetEditor.SnippetsMenu.prototype.events,{'click .o_we_customize_theme_btn':'_onThemeTabClick','click .o_we_animate_text':'_onAnimateTextClick','click .o_we_highlight_animated_text':'_onHighlightAnimatedTextClick',}),custom_events:Object.assign({},weSnippetEditor.SnippetsMenu.prototype.custom_events,{'gmap_api_request':'_onGMapAPIRequest','gmap_api_key_request':'_onGMapAPIKeyRequest',}),tabs:_.extend({},weSnippetEditor.SnippetsMenu.prototype.tabs,{THEME:'theme',}),optionsTabStructure:[['theme-colors',_lt("Theme Colors")],['theme-options',_lt("Theme Options")],['website-settings',_lt("Website Settings")],],async start(){await this._super(...arguments);this.$currentAnimatedText=$();this.__onSelectionChange=ev=>{this._toggleAnimatedTextButton();};this.ownerDocument.addEventListener('selectionchange',this.__onSelectionChange);},destroy(){this._super(...arguments);this.ownerDocument.removeEventListener('selectionchange',this.__onSelectionChange);document.body.classList.remove('o_animated_text_highlighted');},_computeSnippetTemplates:function(html){const $html=$(html);const fontVariables=_.map($html.find('we-fontfamilypicker[data-variable]'),el=>{return el.dataset.variable;});FontFamilyPickerUserValueWidget.prototype.fontVariables=fontVariables;return this._super(...arguments);},async _configureGMapAPI({reconfigure,onlyIfUndefined}){const apiKey=await new Promise(resolve=>{this.getParent().trigger_up('gmap_api_key_request',{onSuccess:key=>resolve(key),});});if(!reconfigure&&(apiKey||!onlyIfUndefined)){return false;}
let websiteId;this.trigger_up('context_get',{callback:ctx=>websiteId=ctx['website_id'],});return new Promise(resolve=>{let invalidated=false;const dialog=new Dialog(this,{size:'medium',title:_t("Google Map API Key"),buttons:[{text:_t("Save"),classes:'btn-primary',click:async(ev)=>{const $apiKeyInput=dialog.$('#api_key_input');const valueAPIKey=$apiKeyInput.val();const $apiKeyHelp=dialog.$('#api_key_help');if(!valueAPIKey){$apiKeyInput.addClass('is-invalid');$apiKeyHelp.text(_t("Enter an API Key"));return;}
const $button=$(ev.currentTarget);$button.prop('disabled',true);try{const response=await fetch(`https://maps.googleapis.com/maps/api/staticmap?center=belgium&size=10x10&key=${valueAPIKey}`);if(response.status===200){await this._rpc({model:'website',method:'write',args:[[websiteId],{google_maps_api_key:valueAPIKey},],});invalidated=true;dialog.close();}else{const text=await response.text();$apiKeyInput.addClass('is-invalid');$apiKeyHelp.empty().text(_t("Invalid API Key. The following error was returned by Google:")).append($('<i/>',{text:text,class:'ml-1',}));}}catch(e){$apiKeyHelp.text(_t("Check your connection and try again"));}finally{$button.prop("disabled",false);}}},{text:_t("Cancel"),close:true}],$content:$(qweb.render('website.s_google_map_modal',{apiKey:apiKey,})),});dialog.on('closed',this,()=>resolve(invalidated));dialog.open();});},_getScrollOptions(options={}){const finalOptions=this._super(...arguments);if(!options.offsetElements||!options.offsetElements.$top){const $header=$('#top');if($header.length){finalOptions.offsetElements=finalOptions.offsetElements||{};finalOptions.offsetElements.$top=$header;}}
return finalOptions;},async _handleGMapRequest(ev,gmapRequestEventName){ev.stopPropagation();const reconfigured=await this._configureGMapAPI({reconfigure:ev.data.reconfigure,onlyIfUndefined:ev.data.configureIfNecessary,});this.getParent().trigger_up(gmapRequestEventName,{refetch:reconfigured,editableMode:true,onSuccess:key=>ev.data.onSuccess(key),});},_updateRightPanelContent:function({content,tab}){this._super(...arguments);this.$('.o_we_customize_theme_btn').toggleClass('active',tab===this.tabs.THEME);},_getAnimatedTextElement(){const editable=this.options.wysiwyg.$editable[0];const animatedTextNode=getTraversedNodes(editable).find(n=>n.parentElement.closest(".o_animated_text"));return animatedTextNode?animatedTextNode.parentElement.closest('.o_animated_text'):false;},_addToolbar(){this._super(...arguments);this.$('#o_we_editor_toolbar_container > we-title > span').after($(`
            <div class="btn fa fa-fw fa-2x o_we_highlight_animated_text d-none
                ${$('body').hasClass('o_animated_text_highlighted') ? 'fa-eye text-success' : 'fa-eye-slash'}"
                title="${_t('Highlight Animated Text')}"
                aria-label="Highlight Animated Text"/>
        `));this._toggleAnimatedTextButton();this._toggleHighlightAnimatedTextButton();},_toggleAnimatedTextButton(){if(!this._isValidSelection(window.getSelection())){return;}
const animatedText=this._getAnimatedTextElement();this.$('.o_we_animate_text').toggleClass('active',!!animatedText);this.$currentAnimatedText=animatedText?$(animatedText):$();},_toggleHighlightAnimatedTextButton(){const $animatedText=this.getEditableArea().find('.o_animated_text');this.$('#o_we_editor_toolbar_container .o_we_highlight_animated_text').toggleClass('d-none',!$animatedText.length);},_isValidSelection(sel){return sel.rangeCount&&[...this.getEditableArea()].some(el=>el.contains(sel.anchorNode));},_onGMapAPIRequest(ev){this._handleGMapRequest(ev,'gmap_api_request');},_onGMapAPIKeyRequest(ev){this._handleGMapRequest(ev,'gmap_api_key_request');},async _onThemeTabClick(ev){let releaseLoader;try{const promise=new Promise(resolve=>releaseLoader=resolve);this._execWithLoadingEffect(()=>promise,false,0);await new Promise(resolve=>requestAnimationFrame(()=>requestAnimationFrame(resolve)));if(!this.topFakeOptionEl){let el;for(const[elementName,title]of this.optionsTabStructure){const newEl=document.createElement(elementName);newEl.dataset.name=title;if(el){el.appendChild(newEl);}else{this.topFakeOptionEl=newEl;}
el=newEl;}
this.bottomFakeOptionEl=el;this.el.appendChild(this.topFakeOptionEl);}
this.topFakeOptionEl.classList.remove('d-none');const editorPromise=this._activateSnippet($(this.bottomFakeOptionEl));releaseLoader();releaseLoader=undefined;const editor=await editorPromise;this.topFakeOptionEl.classList.add('d-none');editor.toggleOverlay(false);this._updateRightPanelContent({tab:this.tabs.THEME,});}catch(e){if(releaseLoader){releaseLoader();}
throw e;}},_onAnimateTextClick(ev){const sel=window.getSelection();if(!this._isValidSelection(sel)){return;}
const editable=this.options.wysiwyg.$editable[0];const range=getDeepRange(editable,{splitText:true,select:true,correctTripleClick:true});if(this.$currentAnimatedText.length){this.$currentAnimatedText.contents().unwrap();this.options.wysiwyg.odooEditor.historyResetLatestComputedSelection();this._toggleHighlightAnimatedTextButton();ev.target.classList.remove('active');this.options.wysiwyg.odooEditor.historyStep();}else{if(sel.getRangeAt(0).collapsed){return;}
const animatedTextEl=document.createElement('span');animatedTextEl.classList.add('o_animated_text','o_animate','o_animate_preview','o_anim_fade_in');let $snippet=null;try{range.surroundContents(animatedTextEl);$snippet=$(animatedTextEl);}catch(e){if(range.commonAncestorContainer.textContent===range.toString()){const $commonAncestor=$(range.commonAncestorContainer);$commonAncestor.wrapInner(animatedTextEl);$snippet=$commonAncestor.find('.o_animated_text');}}
if($snippet){$snippet[0].normalize();this.trigger_up('activate_snippet',{$snippet:$snippet,previewMode:false,});this.options.wysiwyg.odooEditor.historyStep();}else{this.displayNotification({message:_t("The current text selection cannot be animated. Try clearing the format and try again."),type:'danger',sticky:true,});}}},_onHighlightAnimatedTextClick(ev){$('body').toggleClass('o_animated_text_highlighted');$(ev.target).toggleClass('fa-eye fa-eye-slash').toggleClass('text-success');},});weSnippetEditor.SnippetEditor.include({layoutElementsSelector:[weSnippetEditor.SnippetEditor.prototype.layoutElementsSelector,'.s_parallax_bg','.o_bg_video_container',].join(','),getName(){if(this.$target[0].closest('[data-oe-field=logo]')){return _t("Logo");}
return this._super(...arguments);},});});;

/* /website/static/src/js/editor/snippets.options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.editor.snippets.options',function(require){'use strict';const{ColorpickerWidget}=require('web.Colorpicker');const config=require('web.config');var core=require('web.core');var Dialog=require('web.Dialog');const{Markup,sprintf}=require('web.utils');const weUtils=require('web_editor.utils');var options=require('web_editor.snippets.options');const wLinkPopoverWidget=require('@website/js/widgets/link_popover_widget')[Symbol.for("default")];const wUtils=require('website.utils');require('website.s_popup_options');var _t=core._t;var qweb=core.qweb;const InputUserValueWidget=options.userValueWidgetsRegistry['we-input'];const SelectUserValueWidget=options.userValueWidgetsRegistry['we-select'];options.UserValueWidget.include({loadMethodsData(){this._super(...arguments);const indexVariable=this._methodsNames.indexOf('customizeWebsiteVariable');if(indexVariable>=0){const indexView=this._methodsNames.indexOf('customizeWebsiteViews');if(indexView>=0){this._methodsNames[indexVariable]='customizeWebsiteViews';this._methodsNames[indexView]='customizeWebsiteVariable';}}},});const UrlPickerUserValueWidget=InputUserValueWidget.extend({custom_events:_.extend({},InputUserValueWidget.prototype.custom_events||{},{'website_url_chosen':'_onWebsiteURLChosen',}),events:_.extend({},InputUserValueWidget.prototype.events||{},{'click .o_we_redirect_to':'_onRedirectTo',}),start:async function(){await this._super(...arguments);const linkButton=document.createElement('we-button');const icon=document.createElement('i');icon.classList.add('fa','fa-fw','fa-external-link')
linkButton.classList.add('o_we_redirect_to');linkButton.title=_t("Redirect to URL in a new tab");linkButton.appendChild(icon);this.containerEl.appendChild(linkButton);this.el.classList.add('o_we_large');this.inputEl.classList.add('text-left');const options={position:{collision:'flip fit',},classes:{"ui-autocomplete":'o_website_ui_autocomplete'},}
wUtils.autocompleteWithPages(this,$(this.inputEl),options);},_onWebsiteURLChosen:function(ev){this._value=this.inputEl.value;this._onUserValueChange(ev);},_onRedirectTo:function(){if(this._value){window.open(this._value,'_blank');}},});const FontFamilyPickerUserValueWidget=SelectUserValueWidget.extend({xmlDependencies:(SelectUserValueWidget.prototype.xmlDependencies||[]).concat(['/website/static/src/xml/website.editor.xml']),events:_.extend({},SelectUserValueWidget.prototype.events||{},{'click .o_we_add_google_font_btn':'_onAddGoogleFontClick','click .o_we_delete_google_font_btn':'_onDeleteGoogleFontClick',}),fontVariables:[],start:async function(){const style=window.getComputedStyle(document.documentElement);const nbFonts=parseInt(weUtils.getCSSVariableValue('number-of-fonts',style));const googleFontsProperty=weUtils.getCSSVariableValue('google-fonts',style);this.googleFonts=googleFontsProperty?googleFontsProperty.split(/\s*,\s*/g):[];this.googleFonts=this.googleFonts.map(font=>font.substring(1,font.length-1));await this._super(...arguments);const fontEls=[];const methodName=this.el.dataset.methodName||'customizeWebsiteVariable';const variable=this.el.dataset.variable;_.times(nbFonts,fontNb=>{const realFontNb=fontNb+1;const fontEl=document.createElement('we-button');fontEl.classList.add(`o_we_option_font_${realFontNb}`);fontEl.dataset.variable=variable;fontEl.dataset[methodName]=weUtils.getCSSVariableValue(`font-number-${realFontNb}`,style);fontEl.dataset.font=realFontNb;fontEls.push(fontEl);this.menuEl.appendChild(fontEl);});if(this.googleFonts.length){const googleFontsEls=fontEls.slice(-this.googleFonts.length);googleFontsEls.forEach((el,index)=>{$(el).append(core.qweb.render('website.delete_google_font_btn',{index:index,}));});}
$(this.menuEl).append($(core.qweb.render('website.add_google_font_btn',{variable:variable,})));},async setValue(){await this._super(...arguments);for(const className of this.menuTogglerEl.classList){if(className.match(/^o_we_option_font_\d+$/)){this.menuTogglerEl.classList.remove(className);}}
const activeWidget=this._userValueWidgets.find(widget=>!widget.isPreviewed()&&widget.isActive());if(activeWidget){this.menuTogglerEl.classList.add(`o_we_option_font_${activeWidget.el.dataset.font}`);}},_onAddGoogleFontClick:function(ev){const variable=$(ev.currentTarget).data('variable');const dialog=new Dialog(this,{title:_t("Add a Google Font"),$content:$(core.qweb.render('website.dialog.addGoogleFont')),buttons:[{text:_t("Save & Reload"),classes:'btn-primary',click:async()=>{const inputEl=dialog.el.querySelector('.o_input_google_font');let m=inputEl.value.match(/\bspecimen\/([\w+]+)/);if(!m){m=inputEl.value.match(/\bfamily=([\w+]+)/);if(!m){inputEl.classList.add('is-invalid');return;}}
let isValidFamily=false;try{const result=await fetch("https://fonts.googleapis.com/css?family="+m[1]+':300,300i,400,400i,700,700i',{method:'HEAD'});if(result.ok){isValidFamily=true;}}catch(error){console.error(error);}
if(!isValidFamily){inputEl.classList.add('is-invalid');return;}
const font=m[1].replace(/\+/g,' ');this.googleFonts.push(font);this.trigger_up('google_fonts_custo_request',{values:{[variable]:`'${font}'`},googleFonts:this.googleFonts,});},},{text:_t("Discard"),close:true,},],});dialog.open();},_onDeleteGoogleFontClick:async function(ev){ev.preventDefault();const save=await new Promise(resolve=>{Dialog.confirm(this,_t("Deleting a font requires a reload of the page. This will save all your changes and reload the page, are you sure you want to proceed?"),{confirm_callback:()=>resolve(true),cancel_callback:()=>resolve(false),});});if(!save){return;}
const googleFontIndex=parseInt(ev.target.dataset.fontIndex);const googleFont=this.googleFonts[googleFontIndex];this.googleFonts.splice(googleFontIndex,1);const values={};const style=window.getComputedStyle(document.documentElement);_.each(FontFamilyPickerUserValueWidget.prototype.fontVariables,variable=>{const value=weUtils.getCSSVariableValue(variable,style);if(value.substring(1,value.length-1)===googleFont){values[variable]='null';}});this.trigger_up('google_fonts_custo_request',{values:values,googleFonts:this.googleFonts,});},});const GPSPicker=InputUserValueWidget.extend({events:{'blur input':'_onInputBlur',},init(){this._super(...arguments);this._gmapCacheGPSToPlace={};},async willStart(){await this._super(...arguments);this._gmapLoaded=await new Promise(resolve=>{this.trigger_up('gmap_api_request',{editableMode:true,configureIfNecessary:true,onSuccess:key=>resolve(!!key),});});if(!this._gmapLoaded){this.trigger_up('user_value_widget_critical');return;}},async start(){await this._super(...arguments);this.el.classList.add('o_we_large');if(!this._gmapLoaded){return;}
this._gmapAutocomplete=new google.maps.places.Autocomplete(this.inputEl,{types:['geocode']});google.maps.event.addListener(this._gmapAutocomplete,'place_changed',this._onPlaceChanged.bind(this));},getMethodsParams:function(methodName){return Object.assign({gmapPlace:this._gmapPlace||{}},this._super(...arguments));},async setValue(){await this._super(...arguments);await new Promise(resolve=>{const gps=this._value;if(this._gmapCacheGPSToPlace[gps]){this._gmapPlace=this._gmapCacheGPSToPlace[gps];resolve();return;}
const service=new google.maps.places.PlacesService(document.createElement('div'));const p=gps.substring(1).slice(0,-1).split(',');const location=new google.maps.LatLng(p[0]||0,p[1]||0);service.nearbySearch({location:location,radius:1,},(results,status)=>{const GMAP_CRITICAL_ERRORS=[google.maps.places.PlacesServiceStatus.REQUEST_DENIED,google.maps.places.PlacesServiceStatus.UNKNOWN_ERROR];if(status===google.maps.places.PlacesServiceStatus.OK){service.getDetails({placeId:results[0].place_id,fields:['geometry','formatted_address'],},(place,status)=>{resolve();if(status===google.maps.places.PlacesServiceStatus.OK){this._gmapCacheGPSToPlace[gps]=place;this._gmapPlace=place;}else if(GMAP_CRITICAL_ERRORS.includes(status)){this.trigger_up('user_value_widget_critical');}});}else if(GMAP_CRITICAL_ERRORS.includes(status)){resolve();this.trigger_up('user_value_widget_critical');}});});if(this._gmapPlace){this.inputEl.value=this._gmapPlace.formatted_address;}},_onPlaceChanged(ev){const gmapPlace=this._gmapAutocomplete.getPlace();if(gmapPlace&&gmapPlace.geometry){this._gmapPlace=gmapPlace;const location=this._gmapPlace.geometry.location;this._value=`(${location.lat()},${location.lng()})`;this._gmapCacheGPSToPlace[this._value]=gmapPlace;this._onUserValueChange(ev);}},});options.userValueWidgetsRegistry['we-urlpicker']=UrlPickerUserValueWidget;options.userValueWidgetsRegistry['we-fontfamilypicker']=FontFamilyPickerUserValueWidget;options.userValueWidgetsRegistry['we-gpspicker']=GPSPicker;options.Class.include({xmlDependencies:(options.Class.prototype.xmlDependencies||[]).concat(['/website/static/src/xml/website.editor.xml']),custom_events:_.extend({},options.Class.prototype.custom_events||{},{'google_fonts_custo_request':'_onGoogleFontsCustoRequest',}),specialCheckAndReloadMethodsNames:['customizeWebsiteViews','customizeWebsiteVariable','customizeWebsiteColor'],customizeWebsiteViews:async function(previewMode,widgetValue,params){await this._customizeWebsite(previewMode,widgetValue,params,'views');},customizeWebsiteVariable:async function(previewMode,widgetValue,params){await this._customizeWebsite(previewMode,widgetValue,params,'variable');},customizeWebsiteColor:async function(previewMode,widgetValue,params){await this._customizeWebsite(previewMode,widgetValue,params,'color');},async customizeWebsiteAssets(previewMode,widgetValue,params){await this._customizeWebsite(previewMode,widgetValue,params,'assets');},async _checkIfWidgetsUpdateNeedReload(widgets){const needReload=await this._super(...arguments);if(needReload){return needReload;}
for(const widget of widgets){const methodsNames=widget.getMethodsNames();const specialMethodsNames=[];for(const methodName of methodsNames){if(this.specialCheckAndReloadMethodsNames.includes(methodName)){specialMethodsNames.push(methodName);}}
if(!specialMethodsNames.length){continue;}
const isDebugAssets=config.isDebug('assets');let paramsReload=isDebugAssets;if(!isDebugAssets){for(const methodName of specialMethodsNames){if(widget.getMethodsParams(methodName).reload){paramsReload=true;break;}}}
if(paramsReload){return(isDebugAssets?_t("It appears you are in debug=assets mode, all theme customization options require a page reload in this mode."):true);}}
return false;},_computeWidgetState:async function(methodName,params){switch(methodName){case'customizeWebsiteViews':{return this._getEnabledCustomizeValues(params.possibleValues,true);}
case'customizeWebsiteVariable':{return weUtils.getCSSVariableValue(params.variable);}
case'customizeWebsiteColor':{return weUtils.getCSSVariableValue(params.color);}
case'customizeWebsiteAssets':{return this._getEnabledCustomizeValues(params.possibleValues,false);}}
return this._super(...arguments);},_customizeWebsite:async function(previewMode,widgetValue,params,type){if(previewMode){return;}
switch(type){case'views':await this._customizeWebsiteData(widgetValue,params,true);break;case'variable':await this._customizeWebsiteVariable(widgetValue,params);break;case'color':await this._customizeWebsiteColor(widgetValue,params);break;case'assets':await this._customizeWebsiteData(widgetValue,params,false);break;default:if(params.customCustomization){await params.customCustomization.call(this,widgetValue,params);}}
if(params.reload||config.isDebug('assets')||params.noBundleReload){return;}
await this._reloadBundles();await new Promise((resolve,reject)=>{this.trigger_up('widgets_start_request',{editableMode:true,onSuccess:()=>resolve(),onFailure:()=>reject(),});});},async _customizeWebsiteColor(color,params){await this._customizeWebsiteColors({[params.color]:color},params);},async _customizeWebsiteColors(colors,params){colors=colors||{};const baseURL='/website/static/src/scss/options/colors/';const colorType=params.colorType?(params.colorType+'_'):'';const url=`${baseURL}user_${colorType}color_palette.scss`;const finalColors={};for(const[colorName,color]of Object.entries(colors)){finalColors[colorName]=color;if(color){if(weUtils.isColorCombinationName(color)){finalColors[colorName]=parseInt(color);}else if(!ColorpickerWidget.isCSSColor(color)){finalColors[colorName]=`'${color}'`;}}}
return this._makeSCSSCusto(url,finalColors,params.nullValue);},_customizeWebsiteVariable:async function(value,params){return this._makeSCSSCusto('/website/static/src/scss/options/user_values.scss',{[params.variable]:value,},params.nullValue);},_customizeWebsiteViews:async function(xmlID,params){this._customizeWebsiteData(xmlID,params,true);},async _customizeWebsiteData(value,params,isViewData){const allDataKeys=this._getDataKeysFromPossibleValues(params.possibleValues);const enableDataKeys=value.split(/\s*,\s*/);const disableDataKeys=allDataKeys.filter(value=>!enableDataKeys.includes(value));const resetViewArch=!!params.resetViewArch;return this._rpc({route:'/website/theme_customize_data',params:{'is_view_data':isViewData,'enable':enableDataKeys,'disable':disableDataKeys,'reset_view_arch':resetViewArch,},});},_getXMLIDsFromPossibleValues:function(possibleValues){this._getDataKeysFromPossibleValues(possibleValues);},_getDataKeysFromPossibleValues(possibleValues){const allDataKeys=[];for(const dataKeysStr of possibleValues){allDataKeys.push(...dataKeysStr.split(/\s*,\s*/));}
return allDataKeys.filter((v,i,arr)=>arr.indexOf(v)===i);},async _getEnabledCustomizeValues(possibleValues,isViewData){const allDataKeys=this._getDataKeysFromPossibleValues(possibleValues);const enabledValues=await this._rpc({route:'/website/theme_customize_data_get',params:{'keys':allDataKeys,'is_view_data':isViewData,},});let mostValuesStr='';let mostValuesNb=0;for(const valuesStr of possibleValues){const enableValues=valuesStr.split(/\s*,\s*/);if(enableValues.length>mostValuesNb&&enableValues.every(value=>enabledValues.includes(value))){mostValuesStr=valuesStr;mostValuesNb=enableValues.length;}}
return mostValuesStr;},_makeSCSSCusto:async function(url,values,defaultValue='null'){return this._rpc({route:'/website/make_scss_custo',params:{'url':url,'values':_.mapObject(values,v=>v||defaultValue),},});},_refreshPublicWidgets:async function($el){return new Promise((resolve,reject)=>{this.trigger_up('widgets_start_request',{editableMode:true,$target:$el||this.$target,onSuccess:resolve,onFailure:reject,});});},_reloadBundles:async function(){const bundles=await this._rpc({route:'/website/theme_customize_bundle_reload',});let $allLinks=$();const proms=_.map(bundles,(bundleURLs,bundleName)=>{var $links=$('link[href*="'+bundleName+'"]');$allLinks=$allLinks.add($links);var $newLinks=$();_.each(bundleURLs,url=>{$newLinks=$newLinks.add($('<link/>',{type:'text/css',rel:'stylesheet',href:url,}));});const linksLoaded=new Promise(resolve=>{let nbLoaded=0;$newLinks.on('load error',()=>{if(++nbLoaded>=$newLinks.length){resolve();}});});$links.last().after($newLinks);return linksLoaded;});await Promise.all(proms).then(()=>$allLinks.remove());},_select:async function(previewMode,widget){await this._super(...arguments);if(!widget.$el.closest('[data-no-widget-refresh="true"]').length){await this._refreshPublicWidgets();}},_onGoogleFontsCustoRequest:function(ev){const values=ev.data.values?_.clone(ev.data.values):{};const googleFonts=ev.data.googleFonts;if(googleFonts.length){values['google-fonts']="('"+googleFonts.join("', '")+"')";}else{values['google-fonts']='null';}
this.trigger_up('snippet_edition_request',{exec:async()=>{return this._makeSCSSCusto('/website/static/src/scss/options/user_values.scss',values);}});this.trigger_up('request_save',{reloadEditor:true,});},});function _getLastPreFilterLayerElement($el){const $bgVideo=$el.find('> .o_bg_video_container');if($bgVideo.length){return $bgVideo[0];}
const $parallaxEl=$el.find('> .s_parallax_bg');if($parallaxEl.length){return $parallaxEl[0];}
return null;}
options.registry.BackgroundToggler.include({toggleBgVideo(previewMode,widgetValue,params){if(!widgetValue){this.$target.find('> .o_we_bg_filter').remove();const[bgVideoWidget]=this._requestUserValueWidgets('bg_video_opt');const bgVideoOpt=bgVideoWidget.getParent();return bgVideoOpt._setBgVideo(false,'');}else{this._requestUserValueWidgets('bg_video_opt')[0].el.click();}},_computeWidgetState(methodName,params){if(methodName==='toggleBgVideo'){return this.$target[0].classList.contains('o_background_video');}
return this._super(...arguments);},_getLastPreFilterLayerElement(){const el=_getLastPreFilterLayerElement(this.$target);if(el){return el;}
return this._super(...arguments);},});options.registry.BackgroundShape.include({_getLastPreShapeLayerElement(){const el=this._super(...arguments);if(el){return el;}
return _getLastPreFilterLayerElement(this.$target);}});options.registry.ReplaceMedia.include({setAnchor(previewMode,widgetValue,params){const linkEl=this.$target[0].parentElement;let url=linkEl.getAttribute('href');url=url.split('#')[0];linkEl.setAttribute('href',url+widgetValue);},_computeWidgetState(methodName,params){if(methodName==='setAnchor'){const parentEl=this.$target[0].parentElement;if(parentEl.tagName==='A'){const href=parentEl.getAttribute('href')||'';return href?`#${href.split('#')[1]}`:'';}
return'';}
return this._super(...arguments);},async _computeWidgetVisibility(widgetName,params){if(widgetName==='media_link_anchor_opt'){const parentEl=this.$target[0].parentElement;const linkEl=parentEl.tagName==='A'?parentEl:null;const href=linkEl?linkEl.getAttribute('href'):false;return href&&href.startsWith('/');}
return this._super(...arguments);},async _renderCustomXML(uiFragment){await this._super(...arguments);const oldURLWidgetEl=uiFragment.querySelector('[data-name="media_url_opt"]');const URLWidgetEl=document.createElement('we-urlpicker');for(const{name,value}of oldURLWidgetEl.attributes){URLWidgetEl.setAttribute(name,value);}
URLWidgetEl.title=_t("Hint: Type '/' to search an existing page and '#' to link to an anchor.");oldURLWidgetEl.replaceWith(URLWidgetEl);const hrefValue=this.$target[0].parentElement.getAttribute('href');if(!hrefValue||!hrefValue.startsWith('/')){return;}
const urlWithoutAnchor=hrefValue.split('#')[0];const selectEl=document.createElement('we-select');selectEl.dataset.name='media_link_anchor_opt';selectEl.dataset.dependencies='media_url_opt';selectEl.dataset.noPreview='true';selectEl.setAttribute('string',_t("âŒ™ Page Anchor"));const anchors=await wUtils.loadAnchors(urlWithoutAnchor);for(const anchor of anchors){const weButtonEl=document.createElement('we-button');weButtonEl.dataset.setAnchor=anchor;weButtonEl.textContent=anchor;selectEl.append(weButtonEl);}
URLWidgetEl.after(selectEl);},});options.registry.BackgroundVideo=options.Class.extend({background:function(previewMode,widgetValue,params){if(previewMode==='reset'&&this.videoSrc){return this._setBgVideo(false,this.videoSrc);}
return this._setBgVideo(previewMode,widgetValue);},_computeWidgetState:function(methodName,params){if(methodName==='background'){if(this.$target[0].classList.contains('o_background_video')){return this.$('> .o_bg_video_container iframe').attr('src');}
return'';}
return this._super(...arguments);},_setBgVideo:async function(previewMode,value){this.$('> .o_bg_video_container').toggleClass('d-none',previewMode===true);if(previewMode!==false){return;}
this.videoSrc=value;var target=this.$target[0];target.classList.toggle('o_background_video',!!(value&&value.length));if(value&&value.length){target.dataset.bgVideoSrc=value;}else{delete target.dataset.bgVideoSrc;}
await this._refreshPublicWidgets();},});options.registry.OptionsTab=options.Class.extend({GRAY_PARAMS:{EXTRA_SATURATION:"gray-extra-saturation",HUE:"gray-hue"},init(){this._super(...arguments);this.grayParams={};this.grays={};},async updateUI(){this.$el.find(".o_we_gray_preview").each((_,e)=>{e.style.removeProperty("background-color");});const hues=[];const saturationDiffs=[];let oneHasNoSaturation=false;for(let id=100;id<=900;id+=100){const gray=weUtils.getCSSVariableValue(`${id}`);const grayRGB=ColorpickerWidget.convertCSSColorToRgba(gray);const grayHSL=ColorpickerWidget.convertRgbToHsl(grayRGB.red,grayRGB.green,grayRGB.blue);const baseGray=weUtils.getCSSVariableValue(`base-${id}`);const baseGrayRGB=ColorpickerWidget.convertCSSColorToRgba(baseGray);const baseGrayHSL=ColorpickerWidget.convertRgbToHsl(baseGrayRGB.red,baseGrayRGB.green,baseGrayRGB.blue);if(grayHSL.saturation>0.01){if(grayHSL.lightness>0.01&&grayHSL.lightness<99.99){hues.push(grayHSL.hue);}
if(grayHSL.saturation<99.99){saturationDiffs.push(grayHSL.saturation-baseGrayHSL.saturation);}}else{oneHasNoSaturation=true;}}
this.grayHueIsDefined=!!hues.length;this.grayParams[this.GRAY_PARAMS.HUE]=(!hues.length)?0:Math.round((Math.atan2(hues.map(hue=>Math.sin(hue*Math.PI/180)).reduce((memo,value)=>memo+value,0)/hues.length,hues.map(hue=>Math.cos(hue*Math.PI/180)).reduce((memo,value)=>memo+value,0)/hues.length)*180/Math.PI)+360)%360;this.grayParams[this.GRAY_PARAMS.EXTRA_SATURATION]=saturationDiffs.length?saturationDiffs.reduce((memo,value)=>memo+value,0)/saturationDiffs.length:(oneHasNoSaturation?-100:100);await this._super(...arguments);},async customizeGray(previewMode,widgetValue,params){this.grayParams[params.param]=parseInt(widgetValue);for(let i=1;i<10;i++){const key=(100*i).toString();this.grays[key]=this._buildGray(key);}
this.$el.find(".o_we_gray_preview").each((_,e)=>{e.style.setProperty("background-color",this.grays[e.getAttribute('variable')],"important");});await this._customizeWebsite(previewMode,undefined,Object.assign({},params,{customCustomization:()=>{return this._customizeWebsiteColors(this.grays,Object.assign({},params,{colorType:'gray',}));},}));},async configureApiKey(previewMode,widgetValue,params){return new Promise(resolve=>{this.trigger_up('gmap_api_key_request',{editableMode:true,reconfigure:true,onSuccess:()=>resolve(),});});},async customizeBodyBgType(previewMode,widgetValue,params){if(widgetValue==='NONE'){this.bodyImageType='image';return this.customizeBodyBg(previewMode,'',params);}
this.bodyImageType=widgetValue;const widget=this._requestUserValueWidgets(params.imagepicker)[0];widget.enable();},async customizeBodyBg(previewMode,widgetValue,params){await this.customizeWebsiteVariable(previewMode,this.bodyImageType,{variable:'body-image-type'});await this.customizeWebsiteVariable(previewMode,widgetValue?`'${widgetValue}'`:'',{variable:'body-image'});},async openCustomCodeDialog(previewMode,widgetValue,params){const libsProm=this._loadLibs({jsLibs:['/web/static/lib/ace/ace.js','/web/static/lib/ace/mode-xml.js','/web/static/lib/ace/mode-qweb.js',],});let websiteId;this.trigger_up('context_get',{callback:(ctx)=>{websiteId=ctx['website_id'];},});let website;const dataProm=this._rpc({model:'website',method:'read',args:[[websiteId],['custom_code_head','custom_code_footer']],}).then(websites=>{website=websites[0];});let fieldName,title,contentText;if(widgetValue==='head'){fieldName='custom_code_head';title=_t('Custom head code');contentText=_t('Enter code that will be added into the <head> of every page of your site.');}else{fieldName='custom_code_footer';title=_t('Custom end of body code');contentText=_t('Enter code that will be added before the </body> of every page of your site.');}
await Promise.all([libsProm,dataProm]);await new Promise(resolve=>{const $content=$(core.qweb.render('website.custom_code_dialog_content',{contentText,}));const aceEditor=this._renderAceEditor($content.find('.o_ace_editor_container')[0],website[fieldName]||'');const dialog=new Dialog(this,{title,$content,buttons:[{text:_t("Save"),classes:'btn-primary',click:async()=>{await this._rpc({model:'website',method:'write',args:[[websiteId],{[fieldName]:aceEditor.getValue()},],});},close:true,},{text:_t("Discard"),close:true,},],});dialog.on('closed',this,resolve);dialog.open();});},async switchTheme(previewMode,widgetValue,params){const save=await new Promise(resolve=>{Dialog.confirm(this,_t("Changing theme requires to leave the editor. This will save all your changes, are you sure you want to proceed? Be careful that changing the theme will reset all your color customizations."),{confirm_callback:()=>resolve(true),cancel_callback:()=>resolve(false),});});if(!save){return;}
this.trigger_up('request_save',{reload:false,onSuccess:()=>window.location.href='/web#action=website.theme_install_kanban_action',});},_buildGray(id){const gray=weUtils.getCSSVariableValue(`base-${id}`);const grayRGB=ColorpickerWidget.convertCSSColorToRgba(gray);const hsl=ColorpickerWidget.convertRgbToHsl(grayRGB.red,grayRGB.green,grayRGB.blue);const adjustedGrayRGB=ColorpickerWidget.convertHslToRgb(this.grayParams[this.GRAY_PARAMS.HUE],Math.min(Math.max(hsl.saturation+this.grayParams[this.GRAY_PARAMS.EXTRA_SATURATION],0),100),hsl.lightness);return ColorpickerWidget.convertRgbaToCSSColor(adjustedGrayRGB.red,adjustedGrayRGB.green,adjustedGrayRGB.blue);},async _renderCustomXML(uiFragment){await this._super(...arguments);const extraSaturationRangeEl=uiFragment.querySelector(`we-range[data-param=${this.GRAY_PARAMS.EXTRA_SATURATION}]`);if(extraSaturationRangeEl){const baseGrays=_.range(100,1000,100).map(id=>{const gray=weUtils.getCSSVariableValue(`base-${id}`);const grayRGB=ColorpickerWidget.convertCSSColorToRgba(gray);const hsl=ColorpickerWidget.convertRgbToHsl(grayRGB.red,grayRGB.green,grayRGB.blue);return{id:id,hsl:hsl};});const first=baseGrays[0];const maxValue=baseGrays.reduce((gray,value)=>{return gray.hsl.saturation>value.hsl.saturation?gray:value;},first);const minValue=baseGrays.reduce((gray,value)=>{return gray.hsl.saturation<value.hsl.saturation?gray:value;},first);extraSaturationRangeEl.dataset.max=100-minValue.hsl.saturation;extraSaturationRangeEl.dataset.min=-maxValue.hsl.saturation;}},async _checkIfWidgetsUpdateNeedWarning(widgets){const warningMessage=await this._super(...arguments);if(warningMessage){return warningMessage;}
for(const widget of widgets){if(widget.getMethodsNames().includes('customizeWebsiteVariable')&&widget.getMethodsParams('customizeWebsiteVariable').variable==='color-palettes-name'){const hasCustomizedColors=weUtils.getCSSVariableValue('has-customized-colors');if(hasCustomizedColors&&hasCustomizedColors!=='false'){return _t("Changing the color palette will reset all your color customizations, are you sure you want to proceed?");}}}
return'';},async _computeWidgetState(methodName,params){if(methodName==='customizeBodyBgType'){const bgImage=$('#wrapwrap').css('background-image');if(bgImage==='none'){return"NONE";}
return weUtils.getCSSVariableValue('body-image-type');}
if(methodName==='customizeGray'){return this.grayParams[params.param];}
return this._super(...arguments);},async _computeWidgetVisibility(widgetName,params){if(widgetName==='body_bg_image_opt'){return false;}
if(params.param===this.GRAY_PARAMS.HUE){return this.grayHueIsDefined;}
return this._super(...arguments);},_renderAceEditor(node,content){const aceEditor=window.ace.edit(node);aceEditor.setTheme('ace/theme/monokai');aceEditor.setValue(content,1);aceEditor.setOptions({minLines:20,maxLines:Infinity,showPrintMargin:false,});aceEditor.renderer.setOptions({highlightGutterLine:true,showInvisibles:true,fontSize:14,});const aceSession=aceEditor.getSession();aceSession.setOptions({mode:"ace/mode/qweb",useWorker:false,});return aceEditor;},async _renderCustomXML(uiFragment){uiFragment.querySelectorAll('we-colorpicker').forEach(el=>{el.dataset.lazyPalette='true';});},});options.registry.ThemeColors=options.registry.OptionsTab.extend({async start(){const style=window.getComputedStyle(document.documentElement);const supportOldColorSystem=weUtils.getCSSVariableValue('support-13-0-color-system',style)==='true';const hasCustomizedOldColorSystem=weUtils.getCSSVariableValue('has-customized-13-0-color-system',style)==='true';this._showOldColorSystemWarning=supportOldColorSystem&&hasCustomizedOldColorSystem;return this._super(...arguments);},async updateUIVisibility(){await this._super(...arguments);const oldColorSystemEl=this.el.querySelector('.o_old_color_system_warning');oldColorSystemEl.classList.toggle('d-none',!this._showOldColorSystemWarning);},async _renderCustomXML(uiFragment){const paletteSelectorEl=uiFragment.querySelector('[data-variable="color-palettes-name"]');const style=window.getComputedStyle(document.documentElement);const allPaletteNames=weUtils.getCSSVariableValue('palette-names',style).split(', ').map((name)=>{return name.replace(/'/g,"");});for(const paletteName of allPaletteNames){const btnEl=document.createElement('we-button');btnEl.classList.add('o_palette_color_preview_button');btnEl.dataset.customizeWebsiteVariable=`'${paletteName}'`;[1,3,2].forEach(c=>{const colorPreviewEl=document.createElement('span');colorPreviewEl.classList.add('o_palette_color_preview');const color=weUtils.getCSSVariableValue(`o-palette-${paletteName}-o-color-${c}`,style);colorPreviewEl.style.backgroundColor=color;btnEl.appendChild(colorPreviewEl);});paletteSelectorEl.appendChild(btnEl);}
for(let i=1;i<=5;i++){const collapseEl=document.createElement('we-collapse');const ccPreviewEl=$(qweb.render('web_editor.color.combination.preview'))[0];ccPreviewEl.classList.add('text-center',`o_cc${i}`,'o_we_collapse_toggler');collapseEl.appendChild(ccPreviewEl);const editionEls=$(qweb.render('website.color_combination_edition',{number:i}));for(const el of editionEls){collapseEl.appendChild(el);}
uiFragment.appendChild(collapseEl);}
await this._super(...arguments);},});options.registry.menu_data=options.Class.extend({start:function(){wLinkPopoverWidget.createFor(this,this.$target[0],{wysiwyg:$('#wrapwrap').data('wysiwyg')});return this._super(...arguments);},onBlur:function(){this.$target.popover('hide');},});options.registry.company_data=options.Class.extend({start:function(){var proto=options.registry.company_data.prototype;var prom;var self=this;if(proto.__link===undefined){prom=this._rpc({route:'/web/session/get_session_info'}).then(function(session){return self._rpc({model:'res.users',method:'read',args:[session.uid,['company_id']],});}).then(function(res){proto.__link='/web#action=base.action_res_company_form&view_type=form&id='+(res&&res[0]&&res[0].company_id[0]||1);});}
return Promise.all([this._super.apply(this,arguments),prom]);},onFocus:function(){var self=this;var proto=options.registry.company_data.prototype;Dialog.confirm(this,_t("Do you want to edit the company data ?"),{confirm_callback:function(){self.trigger_up('request_save',{reload:false,onSuccess:function(){window.location.href=proto.__link;},});},});},});options.registry.Carousel=options.Class.extend({start:function(){this.$target.carousel('pause');this.$indicators=this.$target.find('.carousel-indicators');this.$controls=this.$target.find('.carousel-control-prev, .carousel-control-next, .carousel-indicators');this.$controls.addClass('o_we_no_overlay');let _slideTimestamp;this.$target.on('slide.bs.carousel.carousel_option',()=>{_slideTimestamp=window.performance.now();setTimeout(()=>this.trigger_up('hide_overlay'));});this.$target.on('slid.bs.carousel.carousel_option',()=>{const _slideDuration=(window.performance.now()-_slideTimestamp);setTimeout(()=>{this.trigger_up('activate_snippet',{$snippet:this.$target.find('.carousel-item.active'),ifInactiveOptions:true,});this.$target.trigger('active_slide_targeted');},0.2*_slideDuration);});return this._super.apply(this,arguments);},destroy:function(){this._super.apply(this,arguments);this.$target.off('.carousel_option');},onBuilt:function(){this._assignUniqueID();},onClone:function(){this._assignUniqueID();},cleanForSave:function(){const $items=this.$target.find('.carousel-item');$items.removeClass('next prev left right active').first().addClass('active');this.$indicators.find('li').removeClass('active').empty().first().addClass('active');},notify:function(name,data){this._super(...arguments);if(name==='add_slide'){this._addSlide();}},addSlide(previewMode,widgetValue,params){this._addSlide();},_assignUniqueID:function(){const id='myCarousel'+Date.now();this.$target.attr('id',id);this.$target.find('[data-target]').attr('data-target','#'+id);_.each(this.$target.find('[data-slide], [data-slide-to]'),function(el){var $el=$(el);if($el.attr('data-target')){$el.attr('data-target','#'+id);}else if($el.attr('href')){$el.attr('href','#'+id);}});},_addSlide(){const $items=this.$target.find('.carousel-item');this.$controls.removeClass('d-none');const $active=$items.filter('.active');this.$indicators.append($('<li>',{'data-target':'#'+this.$target.attr('id'),'data-slide-to':$items.length,}));this.$indicators.append(' ');$active.clone(false).removeClass('active').insertAfter($active);this.$target.carousel('next');},});options.registry.CarouselItem=options.Class.extend({isTopOption:true,forceNoDeleteButton:true,start:function(){this.$carousel=this.$target.closest('.carousel');this.$indicators=this.$carousel.find('.carousel-indicators');this.$controls=this.$carousel.find('.carousel-control-prev, .carousel-control-next, .carousel-indicators');var leftPanelEl=this.$overlay.data('$optionsSection')[0];var titleTextEl=leftPanelEl.querySelector('we-title > span');this.counterEl=document.createElement('span');titleTextEl.appendChild(this.counterEl);return this._super(...arguments);},destroy:function(){this._super(...arguments);this.$carousel.off('.carousel_item_option');},updateUI:async function(){await this._super(...arguments);const $items=this.$carousel.find('.carousel-item');const $activeSlide=$items.filter('.active');const updatedText=` (${$activeSlide.index() + 1}/${$items.length})`;this.counterEl.textContent=updatedText;},addSlideItem(previewMode,widgetValue,params){this.trigger_up('option_update',{optionName:'Carousel',name:'add_slide',});},removeSlide:function(previewMode){const $items=this.$carousel.find('.carousel-item');const newLength=$items.length-1;if(!this.removing&&newLength>0){const $toDelete=$items.filter('.active');this.$carousel.one('active_slide_targeted.carousel_item_option',()=>{$toDelete.remove();this.$indicators.find('li:last').remove();this.$controls.toggleClass('d-none',newLength===1);this.$carousel.trigger('content_changed');this.removing=false;});this.removing=true;this.$carousel.carousel('prev');}},slide:function(previewMode,widgetValue,params){switch(widgetValue){case'left':this.$controls.filter('.carousel-control-prev')[0].click();break;case'right':this.$controls.filter('.carousel-control-next')[0].click();break;}},});options.registry.Parallax=options.Class.extend({async start(){this.parallaxEl=this.$target.find('> .s_parallax_bg')[0]||null;this._updateBackgroundOptions();this.$target.on('content_changed.ParallaxOption',this._onExternalUpdate.bind(this));return this._super(...arguments);},onFocus(){if(this.parallaxEl){this._refreshPublicWidgets();}},onMove(){this._refreshPublicWidgets();},destroy(){this._super(...arguments);this.$target.off('.ParallaxOption');},async selectDataAttribute(previewMode,widgetValue,params){await this._super(...arguments);if(params.attributeName!=='scrollBackgroundRatio'){return;}
const isParallax=(widgetValue!=='0');this.$target.toggleClass('parallax',isParallax);this.$target.toggleClass('s_parallax_is_fixed',widgetValue==='1');this.$target.toggleClass('s_parallax_no_overflow_hidden',(widgetValue==='0'||widgetValue==='1'));if(isParallax){if(!this.parallaxEl){this.parallaxEl=document.createElement('span');this.parallaxEl.classList.add('s_parallax_bg');this.$target.prepend(this.parallaxEl);}}else{if(this.parallaxEl){this.parallaxEl.remove();this.parallaxEl=null;}}
this._updateBackgroundOptions();},async _computeVisibility(widgetName){return!this.$target.hasClass('o_background_video');},async _computeWidgetState(methodName,params){if(methodName==='selectDataAttribute'&&params.parallaxTypeOpt){const attrName=params.attributeName;const attrValue=(this.$target[0].dataset[attrName]||params.attributeDefaultValue).trim();switch(attrValue){case'0':case'1':{return attrValue;}
default:{return(attrValue.startsWith('-')?'-1.5':'1.5');}}}
return this._super(...arguments);},_updateBackgroundOptions(){this.trigger_up('option_update',{optionNames:['BackgroundImage','BackgroundPosition','BackgroundOptimize'],name:'target',data:this.parallaxEl?$(this.parallaxEl):this.$target,});},_onExternalUpdate(ev){if(!this.parallaxEl){return;}
const bgImage=this.parallaxEl.style.backgroundImage;if(!bgImage||bgImage==='none'||this.$target.hasClass('o_background_video')){const widget=this._requestUserValueWidgets('parallax_none_opt')[0];widget.enable();widget.getParent().close();}},});options.registry.collapse=options.Class.extend({start:function(){var self=this;this.$target.on('shown.bs.collapse hidden.bs.collapse','[role="tabpanel"]',function(){self.trigger_up('cover_update');self.$target.trigger('content_changed');});return this._super.apply(this,arguments);},onBuilt:function(){this._createIDs();},onClone:function(){this._createIDs();},onMove:function(){this._createIDs();var $panel=this.$target.find('.collapse').removeData('bs.collapse');if($panel.attr('aria-expanded')==='true'){$panel.closest('.accordion').find('.collapse[aria-expanded="true"]').filter((i,el)=>(el!==$panel[0])).collapse('hide').one('hidden.bs.collapse',function(){$panel.trigger('shown.bs.collapse');});}},_createIDs:function(){let time=new Date().getTime();const $tablist=this.$target.closest('[role="tablist"]');const $tab=this.$target.find('[role="tab"]');const $panel=this.$target.find('[role="tabpanel"]');const setUniqueId=($elem,label)=>{let elemId=$elem.attr('id');if(!elemId||$('[id="'+elemId+'"]').length>1){do{time++;elemId=label+time;}while($('#'+elemId).length);$elem.attr('id',elemId);}
return elemId;};const tablistId=setUniqueId($tablist,'myCollapse');$panel.attr('data-parent','#'+tablistId);$panel.data('parent','#'+tablistId);const panelId=setUniqueId($panel,'myCollapseTab');$tab.attr('data-target','#'+panelId);$tab.data('target','#'+panelId);},});options.registry.WebsiteLevelColor=options.Class.extend({specialCheckAndReloadMethodsNames:options.Class.prototype.specialCheckAndReloadMethodsNames.concat(['customizeWebsiteLayer2Color']),async customizeWebsiteLayer2Color(previewMode,widgetValue,params){if(previewMode){return;}
params.color=params.layerColor;params.variable=params.layerGradient;let color=undefined;let gradient=undefined;if(weUtils.isColorGradient(widgetValue)){color='';gradient=widgetValue;}else{color=widgetValue;gradient='';}
await this.customizeWebsiteVariable(previewMode,gradient,params);params.noBundleReload=false;return this.customizeWebsiteColor(previewMode,color,params);},async _computeWidgetState(methodName,params){if(methodName==='customizeWebsiteLayer2Color'){params.variable=params.layerGradient;const gradient=await this._computeWidgetState('customizeWebsiteVariable',params);if(gradient){return gradient.substring(1,gradient.length-1);}
params.color=params.layerColor;return this._computeWidgetState('customizeWebsiteColor',params);}
return this._super(...arguments);},});options.registry.HeaderNavbar=options.Class.extend({init(){this._super(...arguments);this.setTarget(this.$target.closest('#wrapwrap > header'));},async updateUIVisibility(){await this._super(...arguments);const noHamburgerWidget=this.findWidget('no_hamburger_opt');const noHamburgerHidden=noHamburgerWidget.$el.hasClass('d-none');if(noHamburgerHidden&&noHamburgerWidget.isActive()){this.findWidget('default_hamburger_opt').enable();}
const hamburgerTypeWidget=this.findWidget('header_hamburger_type_opt');const labelEl=hamburgerTypeWidget.el.querySelector('we-title');if(!this._originalHamburgerTypeLabel){this._originalHamburgerTypeLabel=labelEl.textContent;}
labelEl.textContent=noHamburgerHidden?this._originalHamburgerTypeLabel:_t("Mobile menu");},async _computeWidgetVisibility(widgetName,params){switch(widgetName){case'option_logo_height_scrolled':{return!this.$('.navbar-brand').hasClass('d-none');}
case'no_hamburger_opt':{return!weUtils.getCSSVariableValue('header-template').includes('hamburger');}}
return this._super(...arguments);},});const VisibilityPageOptionUpdate=options.Class.extend({pageOptionName:undefined,showOptionWidgetName:undefined,shownValue:'',async start(){await this._super(...arguments);const shown=await this._isShown();this.trigger_up('snippet_option_visibility_update',{show:shown});},async onTargetShow(){if(await this._isShown()){return;}
const widget=this._requestUserValueWidgets(this.showOptionWidgetName)[0];widget.enable();},async visibility(previewMode,widgetValue,params){const show=(widgetValue!=='hidden');await new Promise(resolve=>{this.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:this.pageOptionName,value:show}],onSuccess:()=>resolve(),});});this.trigger_up('snippet_option_visibility_update',{show:show});},async _computeWidgetState(methodName,params){if(methodName==='visibility'){const shown=await this._isShown();return shown?this.shownValue:'hidden';}
return this._super(...arguments);},async _isShown(){return new Promise(resolve=>{this.trigger_up('action_demand',{actionName:'get_page_option',params:[this.pageOptionName],onSuccess:v=>resolve(!!v),});});},});options.registry.TopMenuVisibility=VisibilityPageOptionUpdate.extend({pageOptionName:'header_visible',showOptionWidgetName:'regular_header_visibility_opt',async visibility(previewMode,widgetValue,params){await this._super(...arguments);await this._changeVisibility(widgetValue);$(window).trigger('resize');},async _changeVisibility(widgetValue){const show=(widgetValue!=='hidden');if(!show){return;}
const transparent=(widgetValue==='transparent');await new Promise(resolve=>{this.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:'header_overlay',value:transparent}],onSuccess:()=>resolve(),});});if(!transparent){return;}
await new Promise(resolve=>{this.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:'header_color',value:''}],onSuccess:()=>resolve(),});});},async _computeWidgetState(methodName,params){const _super=this._super.bind(this);if(methodName==='visibility'){this.shownValue=await new Promise(resolve=>{this.trigger_up('action_demand',{actionName:'get_page_option',params:['header_overlay'],onSuccess:v=>resolve(v?'transparent':'regular'),});});}
return _super(...arguments);},});options.registry.topMenuColor=options.Class.extend({selectStyle(previewMode,widgetValue,params){this._super(...arguments);const className=widgetValue?(params.colorPrefix+widgetValue):'';this.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:'header_color',value:className}],});},_computeVisibility:async function(){const show=await this._super(...arguments);if(!show){return false;}
return new Promise(resolve=>{this.trigger_up('action_demand',{actionName:'get_page_option',params:['header_overlay'],onSuccess:value=>resolve(!!value),});});},});options.registry.MobileVisibility=options.Class.extend({isTopOption:true,async updateUI(){await this._super(...arguments);const $button=this.$el.find('we-button');$button.attr('title',$button.hasClass('active')?_t("Visible on mobile"):_t("Hidden on mobile"));},showOnMobile(previewMode,widgetValue,params){const classes=`d-none d-md-${this.$target.css('display')}`;this.$target.toggleClass(classes,!widgetValue);},async _computeWidgetState(methodName,params){if(methodName==='showOnMobile'){const classList=[...this.$target[0].classList];return classList.includes('d-none')&&classList.some(className=>className.startsWith('d-md-'))?'':'true';}
return await this._super(...arguments);},});options.registry.HideFooter=VisibilityPageOptionUpdate.extend({pageOptionName:'footer_visible',showOptionWidgetName:'hide_footer_page_opt',shownValue:'shown',});options.registry.anchor=options.Class.extend({isTopOption:true,start:function(){this.$button=this.$el.find('we-button');const clipboard=new ClipboardJS(this.$button[0],{text:()=>this._getAnchorLink()});clipboard.on('success',()=>{const anchor=decodeURIComponent(this._getAnchorLink());const message=sprintf(Markup(_t("Anchor copied to clipboard<br>Link: %s")),anchor);this.displayNotification({type:'success',message:message,buttons:[{text:_t("Edit"),click:()=>this.openAnchorDialog(),primary:true}],});});return this._super.apply(this,arguments);},onClone:function(){this.$target.removeAttr('data-anchor');this.$target.filter(':not(.carousel)').removeAttr('id');},openAnchorDialog:function(previewMode,widgetValue,params){var self=this;var buttons=[{text:_t("Save & copy"),classes:'btn-primary',click:function(){var $input=this.$('.o_input_anchor_name');var anchorName=self._text2Anchor($input.val());if(self.$target[0].id===anchorName){this.close();return;}
const alreadyExists=!!document.getElementById(anchorName);this.$('.o_anchor_already_exists').toggleClass('d-none',!alreadyExists);$input.toggleClass('is-invalid',alreadyExists);if(!alreadyExists){self._setAnchorName(anchorName);this.close();self.$button[0].click();}},},{text:_t("Discard"),close:true,}];if(this.$target.attr('id')){buttons.push({text:_t("Remove"),classes:'btn-link ml-auto',icon:'fa-trash',close:true,click:function(){self._setAnchorName();},});}
new Dialog(this,{title:_t("Link Anchor"),$content:$(qweb.render('website.dialog.anchorName',{currentAnchor:decodeURIComponent(this.$target.attr('id')),})),buttons:buttons,}).open();},_setAnchorName:function(value){if(value){this.$target.attr({'id':value,'data-anchor':true,});}else{this.$target.removeAttr('id data-anchor');}
this.$target.trigger('content_changed');},_getAnchorLink:function(){if(!this.$target[0].id){const $titles=this.$target.find('h1, h2, h3, h4, h5, h6');const title=$titles.length>0?$titles[0].innerText:this.data.snippetName;const anchorName=this._text2Anchor(title);let n='';while(document.getElementById(anchorName+n)){n=(n||1)+1;}
this._setAnchorName(anchorName+n);}
return`${window.location.pathname}#${this.$target[0].id}`;},_text2Anchor:function(text){return encodeURIComponent(text.trim().replace(/\s+/g,'-'));},});options.registry.HeaderBox=options.registry.Box.extend({async selectStyle(previewMode,widgetValue,params){if((params.variable||params.color)&&['border-width','border-style','border-color','border-radius','box-shadow'].includes(params.cssProperty)){if(previewMode){return;}
if(params.cssProperty==='border-color'){return this.customizeWebsiteColor(previewMode,widgetValue,params);}
return this.customizeWebsiteVariable(previewMode,widgetValue,params);}
return this._super(...arguments);},async setShadow(previewMode,widgetValue,params){if(params.variable){if(previewMode){return;}
const defaultShadow=this._getDefaultShadow(widgetValue,params.shadowClass);return this.customizeWebsiteVariable(previewMode,defaultShadow||'none',params);}
return this._super(...arguments);},});options.registry.CookiesBar=options.registry.SnippetPopup.extend({xmlDependencies:(options.registry.SnippetPopup.prototype.xmlDependencies||[]).concat(['/website/static/src/xml/website.cookies_bar.xml']),selectLayout:function(previewMode,widgetValue,params){let websiteId;this.trigger_up('context_get',{callback:function(ctx){websiteId=ctx['website_id'];},});const $template=$(qweb.render(`website.cookies_bar.${widgetValue}`,{websiteId:websiteId,}));const $content=this.$target.find('.modal-content');const selectorsToKeep=['.o_cookies_bar_text_button','.o_cookies_bar_text_policy','.o_cookies_bar_text_title','.o_cookies_bar_text_primary','.o_cookies_bar_text_secondary',];if(this.$savedSelectors===undefined){this.$savedSelectors=[];}
for(const selector of selectorsToKeep){const $currentLayoutEls=$content.find(selector).contents();const $newLayoutEl=$template.find(selector);if($currentLayoutEls.length){this.$savedSelectors[selector]=$currentLayoutEls;}
const $savedSelector=this.$savedSelectors[selector];if($newLayoutEl.length&&$savedSelector&&$savedSelector.length){$newLayoutEl.empty().append($savedSelector);}}
$content.empty().append($template);},onTargetShow:async function(){this.$target.parent('#website_cookies_bar').show();this._super(...arguments);},onTargetHide:async function(){this.$target.parent('#website_cookies_bar').hide();this._super(...arguments);},cleanForSave:function(){this.$target.parent('#website_cookies_bar').show();},});options.registry.CoverProperties=options.Class.extend({init:function(){this._super.apply(this,arguments);this.$image=this.$target.find('.o_record_cover_image');this.$filter=this.$target.find('.o_record_cover_filter');},start:function(){this.$filterValueOpts=this.$el.find('[data-filter-value]');return this._super.apply(this,arguments);},background:async function(previewMode,widgetValue,params){if(widgetValue===''){this.$image.css('background-image','');this.$target.removeClass('o_record_has_cover');}else{this.$image.css('background-image',`url('${widgetValue}')`);this.$target.addClass('o_record_has_cover');const $defaultSizeBtn=this.$el.find('.o_record_cover_opt_size_default');$defaultSizeBtn.click();$defaultSizeBtn.closest('we-select').click();}
if(!previewMode){this._updateSavingDataset();}},filterValue:function(previewMode,widgetValue,params){this.$filter.css('opacity',widgetValue||0);this.$filter.toggleClass('oe_black',parseFloat(widgetValue)!==0);if(!previewMode){this._updateSavingDataset();}},selectStyle:async function(previewMode,widgetValue,params){await this._super(...arguments);if(!previewMode){this._updateSavingDataset(widgetValue);}},selectClass:async function(previewMode,widgetValue,params){await this._super(...arguments);if(!previewMode){this._updateSavingDataset();}},_computeWidgetState:function(methodName,params){switch(methodName){case'filterValue':{return parseFloat(this.$filter.css('opacity')).toFixed(1);}
case'background':{const background=this.$image.css('background-image');if(background&&background!=='none'){return background.match(/^url\(["']?(.+?)["']?\)$/)[1];}
return'';}}
return this._super(...arguments);},_computeWidgetVisibility:function(widgetName,params){if(params.coverOptName){return this.$target.data(`use_${params.coverOptName}`)==='True';}
return this._super(...arguments);},async _renderCustomXML(uiFragment){uiFragment.querySelectorAll('[data-cover-opt-name]').forEach(el=>{el.dataset.name=`${el.dataset.coverOptName}_opt`;});},_updateColorDataset(bgColorStyle='',bgColorClass=''){this.$target[0].dataset.bgColorStyle=bgColorStyle;if(bgColorClass){this.$target[0].dataset.bgColorClass=bgColorClass;}},_updateSavingDataset(colorValue){const[colorPickerWidget,sizeWidget,textAlignWidget]=this._requestUserValueWidgets('bg_color_opt','size_opt','text_align_opt');if(!colorPickerWidget){if(colorValue){this._updateColorDataset(`background-color: ${colorValue};`);}
return;}
const sizeOptValues=sizeWidget.getMethodsParams('selectClass').possibleValues;let coverClass=[...this.$target[0].classList].filter(value=>sizeOptValues.includes(value)).join(' ');const bg=this.$image.css('background-image');if(bg&&bg!=='none'){coverClass+=" o_record_has_cover";}
const textAlignOptValues=textAlignWidget.getMethodsParams('selectClass').possibleValues;const textAlignClass=[...this.$target[0].classList].filter(value=>textAlignOptValues.includes(value)).join(' ');const filterEl=this.$target[0].querySelector('.o_record_cover_filter');const filterValue=filterEl&&filterEl.style.opacity;this.$target[0].dataset.coverClass=coverClass;this.$target[0].dataset.textAlignClass=textAlignClass;this.$target[0].dataset.filterValue=filterValue||0.0;const ccValue=colorPickerWidget._ccValue;const colorOrGradient=colorPickerWidget._value;const isGradient=weUtils.isColorGradient(colorOrGradient);const isCSSColor=!isGradient&&ColorpickerWidget.isCSSColor(colorOrGradient);const colorNames=[];if(ccValue){colorNames.push(ccValue);}
if(!isGradient&&!isCSSColor){colorNames.push(colorOrGradient);}
const bgColorClass=weUtils.computeColorClasses(colorNames).join(' ');const bgColorStyle=isCSSColor?`background-color: ${colorOrGradient};`:isGradient?`background-color: rgba(0, 0, 0, 0); background-image: ${colorOrGradient};`:'';this._updateColorDataset(bgColorStyle,bgColorClass);},});options.registry.ScrollButton=options.Class.extend({start:async function(){await this._super(...arguments);this.$button=this.$('.o_scroll_button');},updateUIVisibility:async function(){await this._super(...arguments);if(this.$button.length&&this.el.offsetParent===null){this.$button.detach();}},async showScrollButton(previewMode,widgetValue,params){if(widgetValue){this.$button.show();}else{if(previewMode){this.$button.hide();}else{this.$button.detach();}}},toggleButton:function(previewMode,widgetValue,params){if(widgetValue){if(!this.$button.length){const anchor=document.createElement('a');anchor.classList.add('o_scroll_button','mb-3','rounded-circle','align-items-center','justify-content-center','mx-auto','bg-primary','o_not_editable',);anchor.href='#';anchor.contentEditable="false";anchor.title=_t("Scroll down to next section");const arrow=document.createElement('i');arrow.classList.add('fa','fa-angle-down','fa-3x');anchor.appendChild(arrow);this.$button=$(anchor);}
this.$target.append(this.$button);}else{this.$button.detach();}},_computeWidgetState:function(methodName,params){switch(methodName){case'toggleButton':return!!this.$button.parent().length;}
return this._super(...arguments);},});options.registry.ConditionalVisibility=options.Class.extend({init(){this._super(...arguments);this.optionsAttributes=[];},async start(){await this._super(...arguments);for(const widget of this._userValueWidgets){const params=widget.getMethodsParams();if(params.saveAttribute){this.optionsAttributes.push({saveAttribute:params.saveAttribute,attributeName:params.attributeName,callWith:params.callWith||'value',});}}},async onTargetHide(){this.$target[0].classList.add('o_conditional_hidden');},async onTargetShow(){this.$target[0].classList.remove('o_conditional_hidden');},cleanForSave(){this.trigger_up('snippet_option_visibility_update',{show:true});},selectRecord(previewMode,widgetValue,params){const recordsData=JSON.parse(widgetValue);if(recordsData.length){this.$target[0].dataset[params.saveAttribute]=widgetValue;}else{delete this.$target[0].dataset[params.saveAttribute];}
this._updateCSSSelectors();},selectValue(previewMode,widgetValue,params){if(widgetValue){const widgetValueIndex=params.possibleValues.indexOf(widgetValue);const value=[{value:widgetValue,id:widgetValueIndex}];this.$target[0].dataset[params.saveAttribute]=JSON.stringify(value);}else{delete this.$target[0].dataset[params.saveAttribute];}
this._updateCSSSelectors();},async selectDataAttribute(previewMode,widgetValue,params){await this._super(...arguments);if(params.attributeName==='visibility'){const targetEl=this.$target[0];if(widgetValue==='conditional'){const collapseEl=this.$el.children('we-collapse')[0];this._toggleCollapseEl(collapseEl);}else{delete targetEl.dataset.visibility;for(const attribute of this.optionsAttributes){delete targetEl.dataset[attribute.saveAttribute];delete targetEl.dataset[`${attribute.saveAttribute}Rule`];}}
this.trigger_up('snippet_option_visibility_update',{show:true});}else if(!params.isVisibilityCondition){return;}
this._updateCSSSelectors();},async _computeWidgetState(methodName,params){if(methodName==='selectRecord'){return this.$target[0].dataset[params.saveAttribute]||'[]';}
if(methodName==='selectValue'){const selectedValue=this.$target[0].dataset[params.saveAttribute];return selectedValue?JSON.parse(selectedValue)[0].value:params.attributeDefaultValue;}
return this._super(...arguments);},_updateCSSSelectors(){const visibilityIDParts=[];const onlyAttributes=[];const hideAttributes=[];const target=this.$target[0];for(const attribute of this.optionsAttributes){if(target.dataset[attribute.saveAttribute]){let records=JSON.parse(target.dataset[attribute.saveAttribute]).map(record=>{return{id:record.id,value:record[attribute.callWith]};});if(attribute.saveAttribute==='visibilityValueLang'){records=records.map(lang=>{lang.value=lang.value.replace(/_/g,'-');return lang;});}
const hideFor=target.dataset[`${attribute.saveAttribute}Rule`]==='hide';if(hideFor){hideAttributes.push({name:attribute.attributeName,records:records});}else{onlyAttributes.push({name:attribute.attributeName,records:records});}
const type=attribute.attributeName.replace('data-','');const valueIDs=records.map(record=>record.id).sort();visibilityIDParts.push(`${type}_${hideFor ? 'h' : 'o'}_${valueIDs.join('_')}`);}}
const visibilityId=visibilityIDParts.join('_');let selectors='';for(const attribute of onlyAttributes){const selector=attribute.records.reduce((acc,record)=>{return acc+=`:not([${attribute.name}="${record.value}"])`;},'html')+` body:not(.editor_enable) [data-visibility-id="${visibilityId}"]`;selectors+=selector+', ';}
for(const attribute of hideAttributes){const selector=attribute.records.reduce((acc,record,i,a)=>{acc+=`html[${attribute.name}="${record.value}"] body:not(.editor_enable) [data-visibility-id="${visibilityId}"]`;return acc+(i!==a.length-1?',':'');},'');selectors+=selector+', ';}
selectors=selectors.slice(0,-2);if(selectors){this.$target[0].dataset.visibilitySelectors=selectors;}else{delete this.$target[0].dataset.visibilitySelectors;}
if(visibilityId){this.$target[0].dataset.visibilityId=visibilityId;}else{delete this.$target[0].dataset.visibilityId;}},});options.registry.WebsiteAnimate=options.Class.extend({async start(){await this._super(...arguments);this.isAnimatedText=this.$target.hasClass('o_animated_text');this.$optionsSection=this.$overlay.data('$optionsSection');},async onBuilt(){this.$target[0].classList.toggle('o_animate_preview',this.$target[0].classList.contains('o_animate'));},onFocus(){if(this.isAnimatedText){const $toolbar=this.options.wysiwyg.toolbar.$el;$toolbar.append(this.$el);this.$optionsSection.addClass('d-none');}},onBlur(){if(this.isAnimatedText){this.$optionsSection.append(this.$el);}},async selectClass(previewMode,widgetValue,params){await this._super(...arguments);if(params.isAnimationTypeSelection){this._forceAnimation();this.$target.toggleClass('o_animate_preview o_animate',!!widgetValue);}},async _computeWidgetVisibility(widgetName,params){if(widgetName==='animation_launch_opt'){return!this.$target[0].closest('.dropdown');}
return this._super(...arguments);},_forceAnimation(){const $scrollingElement=$().getScrollingElement();this.$target.css('animation-name','dummy');void this.$target[0].offsetWidth;this.$target.addClass('o_animating');$scrollingElement[0].classList.add('o_wanim_overflow_x_hidden');this.$target.css('animation-name','');this.$target.one('webkitAnimationEnd oanimationend msAnimationEnd animationend',()=>{$scrollingElement[0].classList.remove('o_wanim_overflow_x_hidden');this.$target.removeClass('o_animating');});},_computeWidgetVisibility(widgetName,params){if(widgetName==='no_animation_opt'){return!this.isAnimatedText;}
return this._super(...arguments);},});options.registry.MegaMenuLayout=options.registry.SelectTemplate.extend({init(){this._super(...arguments);this.selectTemplateWidgetName='mega_menu_template_opt';},notify(name,data){if(name==='reset_template'){const xmlid=this._getCurrentTemplateXMLID();this._getTemplate(xmlid).then(template=>{this.containerEl.insertAdjacentHTML('beforeend',template);data.onSuccess();});}else{this._super(...arguments);}},_computeWidgetState:function(methodName,params){if(methodName==='selectTemplate'){return this._getCurrentTemplateXMLID();}
return this._super(...arguments);},_getCurrentTemplateXMLID:function(){const templateDefiningClass=this.containerEl.querySelector('section').classList.value.split(' ').filter(cl=>cl.startsWith('s_mega_menu'))[0];return`website.${templateDefiningClass}`;},});options.registry.MegaMenuNoDelete=options.Class.extend({forceNoDeleteButton:true,async onRemove(){await new Promise(resolve=>{this.trigger_up('option_update',{optionName:'MegaMenuLayout',name:'reset_template',data:{onSuccess:()=>resolve(),}});});},});return{UrlPickerUserValueWidget:UrlPickerUserValueWidget,FontFamilyPickerUserValueWidget:FontFamilyPickerUserValueWidget,};});;

/* /website/static/src/snippets/s_facebook_page/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_facebook_page_options',function(require){'use strict';const options=require('web_editor.snippets.options');options.registry.facebookPage=options.Class.extend({willStart:function(){var defs=[this._super.apply(this,arguments)];var defaults={href:'',height:215,width:350,tabs:'',small_header:true,hide_cover:true,show_facepile:false,};this.fbData=_.defaults(_.pick(this.$target.data(),_.keys(defaults)),defaults);if(!this.fbData.href){var self=this;defs.push(this._rpc({model:'website',method:'search_read',args:[[],['social_facebook']],limit:1,}).then(function(res){if(res){self.fbData.href=res[0].social_facebook||'';}}));}
return Promise.all(defs).then(()=>this._markFbElement()).then(()=>this._refreshPublicWidgets());},toggleOption:function(previewMode,widgetValue,params){let optionName=params.optionName;if(optionName.startsWith('tab.')){optionName=optionName.replace('tab.','');if(widgetValue){this.fbData.tabs=this.fbData.tabs.split(',').filter(t=>t!=='').concat([optionName]).join(',');}else{this.fbData.tabs=this.fbData.tabs.split(',').filter(t=>t!==optionName).join(',');}}else{if(optionName==='show_cover'){this.fbData.hide_cover=!widgetValue;}else{this.fbData[optionName]=widgetValue;}}
return this._markFbElement();},pageUrl:function(previewMode,widgetValue,params){this.fbData.href=widgetValue;return this._markFbElement();},_markFbElement:function(){return this._checkURL().then(()=>{if(this.fbData.tabs){this.fbData.height=this.fbData.tabs==='events'?300:500;}else if(this.fbData.small_header){this.fbData.height=this.fbData.show_facepile?165:70;}else{this.fbData.height=this.fbData.show_facepile?225:150;}
_.each(this.fbData,(value,key)=>{this.$target.attr('data-'+key,value);this.$target.data(key,value);});});},_computeWidgetState:function(methodName,params){const optionName=params.optionName;switch(methodName){case'toggleOption':{if(optionName.startsWith('tab.')){return this.fbData.tabs.split(',').includes(optionName.replace(/^tab./,''));}else{if(optionName==='show_cover'){return!this.fbData.hide_cover;}
return this.fbData[optionName];}}
case'pageUrl':{return this._checkURL().then(()=>this.fbData.href);}}
return this._super(...arguments);},_checkURL:function(){const defaultURL='https://www.facebook.com/Odoo';const match=this.fbData.href.match(/^(?:https?:\/\/)?(?:www\.)?(?:fb|facebook)\.com\/(?:([\w.]+)|[^/?#]+-([0-9]{15,16}))(?:$|[/?# ])/);if(match){return new Promise((resolve,reject)=>$.ajax({url:'https://graph.facebook.com/'+(match[2]||match[1])+'/picture',success:()=>resolve(),error:()=>{this.fbData.href=defaultURL;resolve();},}));}
this.fbData.href=defaultURL;return Promise.resolve();},});});;

/* /website/static/src/snippets/s_image_gallery/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_image_gallery_options',function(require){'use strict';var core=require('web.core');var weWidgets=require('wysiwyg.widgets');var options=require('web_editor.snippets.options');var _t=core._t;var qweb=core.qweb;options.registry.gallery=options.Class.extend({xmlDependencies:['/website/static/src/snippets/s_image_gallery/000.xml'],start:function(){var self=this;this.$target.on('image_changed','img',function(ev){var $img=$(ev.currentTarget);var index=self.$target.find('.carousel-item.active').index();self.$('.carousel:first li[data-target]:eq('+index+')').css('background-image','url('+$img.attr('src')+')');});this.$target.on('click','.o_add_images',function(e){e.stopImmediatePropagation();self.addImages(false);});this.$target.on('dropped','img',function(ev){self.mode(null,self.getMode());if(!ev.target.height){$(ev.target).one('load',function(){setTimeout(function(){self.trigger_up('cover_update');});});}});const $container=this.$('> .container, > .container-fluid, > .o_container_small');if($container.find('> *:not(div)').length){self.mode(null,self.getMode());}
return this._super.apply(this,arguments);},onBuilt:function(){if(this.$target.find('.o_add_images').length){this.addImages(false);}
this._adaptNavigationIDs();},onClone:function(){this._adaptNavigationIDs();},cleanForSave:function(){if(this.$target.hasClass('slideshow')){this.$target.removeAttr('style');}},addImages:function(previewMode){const $images=this.$('img');var $container=this.$('> .container, > .container-fluid, > .o_container_small');var dialog=new weWidgets.MediaDialog(this,{multiImages:true,onlyImages:true,mediaWidth:1920});var lastImage=_.last(this._getImages());var index=lastImage?this._getIndex(lastImage):-1;return new Promise(resolve=>{dialog.on('save',this,function(attachments){for(var i=0;i<attachments.length;i++){$('<img/>',{class:$images.length>0?$images[0].className:'img img-fluid d-block ',src:attachments[i].image_src,'data-index':++index,alt:attachments[i].description||'','data-name':_t('Image'),style:$images.length>0?$images[0].style.cssText:'',}).appendTo($container);}
if(attachments.length>0){this.mode('reset',this.getMode());this.trigger_up('cover_update');}});dialog.on('closed',this,()=>resolve());dialog.open();});},columns:function(previewMode,widgetValue,params){const nbColumns=parseInt(widgetValue||'1');this.$target.attr('data-columns',nbColumns);this.mode(previewMode,this.getMode(),{});},getMode:function(){var mode='slideshow';if(this.$target.hasClass('o_masonry')){mode='masonry';}
if(this.$target.hasClass('o_grid')){mode='grid';}
if(this.$target.hasClass('o_nomode')){mode='nomode';}
return mode;},grid:function(){var imgs=this._getImages();var $row=$('<div/>',{class:'row s_nb_column_fixed'});var columns=this._getColumns();var colClass='col-lg-'+(12/columns);var $container=this._replaceContent($row);_.each(imgs,function(img,index){var $img=$(img);var $col=$('<div/>',{class:colClass});$col.append($img).appendTo($row);if((index+1)%columns===0){$row=$('<div/>',{class:'row s_nb_column_fixed'});$row.appendTo($container);}});this.$target.css('height','');},masonry:function(){var self=this;var imgs=this._getImages();var columns=this._getColumns();var colClass='col-lg-'+(12/columns);var cols=[];var $row=$('<div/>',{class:'row s_nb_column_fixed'});this._replaceContent($row);for(var c=0;c<columns;c++){var $col=$('<div/>',{class:'o_masonry_col o_snippet_not_selectable '+colClass});$row.append($col);cols.push($col[0]);}
while(imgs.length){var min=Infinity;var $lowest;_.each(cols,function(col){var $col=$(col);var height=$col.is(':empty')?0:$col.find('img').last().offset().top+$col.find('img').last().height()-self.$target.offset().top;if(height<min){min=height;$lowest=$col;}});$lowest.append(imgs.shift());}},mode:function(previewMode,widgetValue,params){widgetValue=widgetValue||'slideshow';this.$target.css('height','');this.$target.removeClass('o_nomode o_masonry o_grid o_slideshow').addClass('o_'+widgetValue);this[widgetValue]();this.trigger_up('cover_update');this._refreshPublicWidgets();},nomode:function(){var $row=$('<div/>',{class:'row s_nb_column_fixed'});var imgs=this._getImages();this._replaceContent($row);_.each(imgs,function(img){var wrapClass='col-lg-3';if(img.width>=img.height*2||img.width>600){wrapClass='col-lg-6';}
var $wrap=$('<div/>',{class:wrapClass}).append(img);$row.append($wrap);});},removeAllImages:function(previewMode){var $addImg=$('<div>',{class:'alert alert-info css_non_editable_mode_hidden text-center',});var $text=$('<span>',{class:'o_add_images',style:'cursor: pointer;',text:_t(" Add Images"),});var $icon=$('<i>',{class:' fa fa-plus-circle',});this._replaceContent($addImg.append($icon).append($text));},slideshow:function(){const imageEls=this._getImages();const images=_.map(imageEls,img=>({src:img.getAttribute('src'),alt:img.getAttribute('alt'),}));var currentInterval=this.$target.find('.carousel:first').attr('data-interval');var params={images:images,index:0,title:"",interval:currentInterval||0,id:'slideshow_'+new Date().getTime(),attrClass:imageEls.length>0?imageEls[0].className:'',attrStyle:imageEls.length>0?imageEls[0].style.cssText:'',},$slideshow=$(qweb.render('website.gallery.slideshow',params));this._replaceContent($slideshow);_.each(this.$('img'),function(img,index){$(img).attr({contenteditable:true,'data-index':index});});this.$target.css('height',Math.round(window.innerHeight*0.7));this.$target.off('slide.bs.carousel').off('slid.bs.carousel');this.$('li.fa').off('click');},notify:function(name,data){this._super(...arguments);if(name==='image_removed'){data.$image.remove();this.mode('reset',this.getMode());}else if(name==='image_index_request'){var imgs=this._getImages();var position=_.indexOf(imgs,data.$image[0]);imgs.splice(position,1);switch(data.position){case'first':imgs.unshift(data.$image[0]);break;case'prev':imgs.splice(position-1,0,data.$image[0]);break;case'next':imgs.splice(position+1,0,data.$image[0]);break;case'last':imgs.push(data.$image[0]);break;}
position=imgs.indexOf(data.$image[0]);_.each(imgs,function(img,index){$(img).attr('data-index',index);});const currentMode=this.getMode();this.mode('reset',currentMode);if(currentMode==='slideshow'){const $carousel=this.$target.find('.carousel');$carousel.removeClass('slide');$carousel.carousel(position);this.$target.find('.carousel-indicators li').removeClass('active');this.$target.find('.carousel-indicators li[data-slide-to="'+position+'"]').addClass('active');this.trigger_up('activate_snippet',{$snippet:this.$target.find('.carousel-item.active img'),ifInactiveOptions:true,});$carousel.addClass('slide');}else{this.trigger_up('activate_snippet',{$snippet:data.$image,ifInactiveOptions:true,});}}},_adaptNavigationIDs:function(){var uuid=new Date().getTime();this.$target.find('.carousel').attr('id','slideshow_'+uuid);_.each(this.$target.find('[data-slide], [data-slide-to]'),function(el){var $el=$(el);if($el.attr('data-target')){$el.attr('data-target','#slideshow_'+uuid);}else if($el.attr('href')){$el.attr('href','#slideshow_'+uuid);}});},_computeWidgetState:function(methodName,params){switch(methodName){case'mode':{let activeModeName='slideshow';for(const modeName of params.possibleValues){if(this.$target.hasClass(`o_${modeName}`)){activeModeName=modeName;break;}}
this.activeMode=activeModeName;return activeModeName;}
case'columns':{return`${this._getColumns()}`;}}
return this._super(...arguments);},async _computeWidgetVisibility(widgetName,params){if(widgetName==='slideshow_mode_opt'){return false;}
return this._super(...arguments);},_getImages:function(){var imgs=this.$('img').get();var self=this;imgs.sort(function(a,b){return self._getIndex(a)-self._getIndex(b);});return imgs;},_getIndex:function(img){return img.dataset.index||0;},_getColumns:function(){return parseInt(this.$target.attr('data-columns'))||3;},_replaceContent:function($content){var $container=this.$('> .container, > .container-fluid, > .o_container_small');$container.empty().append($content);return $container;},});options.registry.gallery_img=options.Class.extend({onRemove:function(){this.trigger_up('option_update',{optionName:'gallery',name:'image_removed',data:{$image:this.$target,},});},position:function(previewMode,widgetValue,params){this.trigger_up('option_update',{optionName:'gallery',name:'image_index_request',data:{$image:this.$target,position:widgetValue,},});},});});;

/* /website/static/src/snippets/s_countdown/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_countdown_options',function(require){'use strict';const core=require('web.core');const options=require('web_editor.snippets.options');const CountdownWidget=require('website.s_countdown');const qweb=core.qweb;options.registry.countdown=options.Class.extend({events:_.extend({},options.Class.prototype.events||{},{'click .toggle-edit-message':'_onToggleEndMessageClick',}),cleanForSave:async function(){this.$target.find('.s_countdown_canvas_wrapper').removeClass("s_countdown_none");this.$target.find('.s_countdown_end_message').removeClass("s_countdown_enable_preview");},endAction:function(previewMode,widgetValue,params){this.$target[0].dataset.endAction=widgetValue;if(widgetValue==='message'||widgetValue==='message_no_countdown'){if(!this.$target.find('.s_countdown_end_message').length){const message=this.endMessage||qweb.render('website.s_countdown.end_message');this.$target.append(message);}
this.$target.toggleClass('hide-countdown',widgetValue==='message_no_countdown');}else{const $message=this.$target.find('.s_countdown_end_message').detach();if(this.showEndMessage){this._onToggleEndMessageClick();}
if($message.length){this.endMessage=$message[0].outerHTML;}}},layout:function(previewMode,widgetValue,params){switch(widgetValue){case'circle':this.$target[0].dataset.progressBarStyle='disappear';this.$target[0].dataset.progressBarWeight='thin';this.$target[0].dataset.layoutBackground='none';break;case'boxes':this.$target[0].dataset.progressBarStyle='none';this.$target[0].dataset.layoutBackground='plain';break;case'clean':this.$target[0].dataset.progressBarStyle='none';this.$target[0].dataset.layoutBackground='none';break;case'text':this.$target[0].dataset.progressBarStyle='none';this.$target[0].dataset.layoutBackground='none';break;}
this.$target[0].dataset.layout=widgetValue;},updateUIVisibility:async function(){await this._super(...arguments);const dataset=this.$target[0].dataset;this.$el.find('.toggle-edit-message').toggleClass('d-none',dataset.endAction==='nothing'||dataset.endAction==='redirect');this.updateUIEndMessage();},updateUIEndMessage:function(){this.$target.find('.s_countdown_canvas_wrapper').toggleClass("s_countdown_none",this.showEndMessage===true&&this.$target.hasClass("hide-countdown"));this.$target.find('.s_countdown_end_message').toggleClass("s_countdown_enable_preview",this.showEndMessage===true);},_computeWidgetState:function(methodName,params){switch(methodName){case'endAction':case'layout':return this.$target[0].dataset[methodName];case'selectDataAttribute':{if(params.colorNames){params.attributeDefaultValue=CountdownWidget.prototype.defaultColor;}
break;}}
return this._super(...arguments);},_onToggleEndMessageClick:function(){this.showEndMessage=!this.showEndMessage;this.$el.find(".toggle-edit-message").toggleClass('text-primary',this.showEndMessage);this.updateUIEndMessage();this.trigger_up('cover_update');},});});;

/* /website/static/src/snippets/s_masonry_block/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('@website/snippets/s_masonry_block/options',async function(require){'use strict';let __exports={};const options=require('web_editor.snippets.options');options.registry.MasonryLayout=options.registry.SelectTemplate.extend({init(){this._super(...arguments);this.containerSelector='> .container, > .container-fluid, > .o_container_small';this.selectTemplateWidgetName='masonry_template_opt';},});return __exports;});;

/* /website/static/src/snippets/s_popup/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_popup_options',function(require){'use strict';const options=require('web_editor.snippets.options');options.registry.SnippetPopup=options.Class.extend({start:function(){this.$target.on('click.SnippetPopup','.js_close_popup:not(a, .btn)',ev=>{ev.stopPropagation();this.onTargetHide();this.trigger_up('snippet_option_visibility_update',{show:false});});this.$target.on('shown.bs.modal.SnippetPopup',()=>{this.trigger_up('snippet_option_visibility_update',{show:true});this.$target[0].querySelectorAll('.media_iframe_video').forEach(media=>{const iframe=media.querySelector('iframe');iframe.src=media.dataset.oeExpression||media.dataset.src;});});this.$target.on('hidden.bs.modal.SnippetPopup',()=>{this.trigger_up('snippet_option_visibility_update',{show:false});this._removeIframeSrc();});this._removeIframeSrc();return this._super(...arguments);},destroy:function(){this._super(...arguments);this._removeIframeSrc();this.$target.off('.SnippetPopup');},onBuilt:function(){this._assignUniqueID();},onClone:function(){this._assignUniqueID();},onTargetShow:async function(){this.$target.modal('show');$(document.body).children('.modal-backdrop:last').addClass('d-none');},onTargetHide:async function(){return new Promise(resolve=>{const timeoutID=setTimeout(()=>{this.$target.off('hidden.bs.modal.popup_on_target_hide');resolve();},500);this.$target.one('hidden.bs.modal.popup_on_target_hide',()=>{clearTimeout(timeoutID);resolve();});this.$target.modal('hide');});},cleanForSave:function(){this.$target.removeClass("s_popup_overflow_page");},moveBlock:function(previewMode,widgetValue,params){const $container=$(widgetValue==='moveToFooter'?'footer':'main');this.$target.closest('.s_popup').prependTo($container.find('.oe_structure:o_editable').first());},setBackdrop(previewMode,widgetValue,params){const color=widgetValue?'var(--black-50)':'';this.$target[0].style.setProperty('background-color',color,'important');},_assignUniqueID:function(){this.$target.closest('.s_popup').attr('id','sPopup'+Date.now());},_computeWidgetState:function(methodName,params){switch(methodName){case'moveBlock':return this.$target.closest('footer').length?'moveToFooter':'moveToBody';}
return this._super(...arguments);},_removeIframeSrc(){this.$target.find('.media_iframe_video iframe').each((i,iframe)=>{iframe.src='';});},});});;

/* /website/static/src/snippets/s_product_catalog/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_product_catalog_options',function(require){'use strict';const core=require('web.core');const options=require('web_editor.snippets.options');const _t=core._t;options.registry.ProductCatalog=options.Class.extend({toggleDescription:function(previewMode,widgetValue,params){const $dishes=this.$('.s_product_catalog_dish');const $name=$dishes.find('.s_product_catalog_dish_name');$name.toggleClass('s_product_catalog_dish_dot_leaders',!widgetValue);if(widgetValue){_.each($dishes,el=>{const $description=$(el).find('.s_product_catalog_dish_description');if($description.length){$description.removeClass('d-none');}else{const descriptionEl=document.createElement('p');descriptionEl.classList.add('s_product_catalog_dish_description','border-top','text-muted','pt-1','o_default_snippet_text');const iEl=document.createElement('i');iEl.textContent=_t("Add a description here");descriptionEl.appendChild(iEl);el.appendChild(descriptionEl);}});}else{_.each($dishes,el=>{const $description=$(el).find('.s_product_catalog_dish_description');if($description.hasClass('o_default_snippet_text')||$description.find('.o_default_snippet_text').length){$description.remove();}else{$description.addClass('d-none');}});}},_computeWidgetState:function(methodName,params){if(methodName==='toggleDescription'){const $description=this.$('.s_product_catalog_dish_description');return $description.length&&!$description.hasClass('d-none');}
return this._super(...arguments);},});});;

/* /website/static/src/snippets/s_chart/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_chart_options',function(require){'use strict';var core=require('web.core');const{ColorpickerWidget}=require('web.Colorpicker');var options=require('web_editor.snippets.options');const weUtils=require('web_editor.utils');var _t=core._t;options.registry.InnerChart=options.Class.extend({custom_events:_.extend({},options.Class.prototype.custom_events,{'get_custom_colors':'_onGetCustomColors',}),events:_.extend({},options.Class.prototype.events,{'click we-button.add_column':'_onAddColumnClick','click we-button.add_row':'_onAddRowClick','click we-button.o_we_matrix_remove_col':'_onRemoveColumnClick','click we-button.o_we_matrix_remove_row':'_onRemoveRowClick','blur we-matrix input':'_onMatrixInputFocusOut','focus we-matrix input':'_onMatrixInputFocus',}),init:function(){this._super.apply(this,arguments);this.themeArray=['o-color-1','o-color-2','o-color-3','o-color-4','o-color-5'];this.style=window.getComputedStyle(document.documentElement);},start:function(){this.backSelectEl=this.el.querySelector('[data-name="chart_bg_color_opt"]');this.borderSelectEl=this.el.querySelector('[data-name="chart_border_color_opt"]');this.tableEl=this.el.querySelector('we-matrix table');const data=JSON.parse(this.$target[0].dataset.data);data.labels.forEach(el=>{this._addRow(el);});data.datasets.forEach((el,i)=>{if(this._isPieChart()){const headerBackgroundColor=this.themeArray[i]||this._randomColor();const headerBorderColor=this.themeArray[i]||this._randomColor();this._addColumn(el.label,el.data,headerBackgroundColor,headerBorderColor,el.backgroundColor,el.borderColor);}else{this._addColumn(el.label,el.data,el.backgroundColor,el.borderColor);}});this._displayRemoveColButton();this._displayRemoveRowButton();this._setDefaultSelectedInput();return this._super(...arguments);},updateUI:async function(){if(!this.lastEditableSelectedInput.closest('table')||this.colorPaletteSelectedInput&&!this.colorPaletteSelectedInput.closest('table')){this._setDefaultSelectedInput();}
await this._super(...arguments);this.tableEl.classList.toggle('o_we_matrix_five_col',this.tableEl.querySelectorAll('tr:first-child th').length>5);this.backSelectEl.querySelector('we-title').textContent=this._isPieChart()?_t("Data Color"):_t("Dataset Color");this.borderSelectEl.querySelector('we-title').textContent=this._isPieChart()?_t("Data Border"):_t("Dataset Border");this.tableEl.querySelectorAll('input').forEach(el=>el.style.border='');const selector=this._isPieChart()?'td input':'tr:first-child input';this.tableEl.querySelectorAll(selector).forEach(el=>{const color=el.dataset.backgroundColor||el.dataset.borderColor;if(color){el.style.border='2px solid';el.style.borderColor=ColorpickerWidget.isCSSColor(color)?color:weUtils.getCSSVariableValue(color,this.style);}});},colorChange:async function(previewMode,widgetValue,params){if(widgetValue){this.colorPaletteSelectedInput.dataset[params.attributeName]=widgetValue;}else{delete this.colorPaletteSelectedInput.dataset[params.attributeName];}
await this._reloadGraph();await new Promise(resolve=>setTimeout(()=>{this.lastEditableSelectedInput.focus();resolve();}));},selectDataAttribute:async function(previewMode,widgetValue,params){await this._super(...arguments);if(params.attributeName==='type'){this._setDefaultSelectedInput();await this._reloadGraph();}},_computeWidgetState:function(methodName,params){if(methodName==='colorChange'){return this.colorPaletteSelectedInput&&this.colorPaletteSelectedInput.dataset[params.attributeName]||'';}
return this._super(...arguments);},_computeWidgetVisibility:function(widgetName,params){switch(widgetName){case'stacked_chart_opt':{return this._getColumnCount()>1;}
case'chart_bg_color_opt':case'chart_border_color_opt':{return!!this.colorPaletteSelectedInput;}}
return this._super(...arguments);},_reloadGraph:async function(){const jsonValue=this._matrixToChartData();if(this.$target[0].dataset.data!==jsonValue){this.$target[0].dataset.data=jsonValue;await this._refreshPublicWidgets();}},_matrixToChartData:function(){const data={labels:[],datasets:[],};this.tableEl.querySelectorAll('tr:first-child input').forEach(el=>{data.datasets.push({label:el.value||'',data:[],backgroundColor:this._isPieChart()?[]:el.dataset.backgroundColor||'',borderColor:this._isPieChart()?[]:el.dataset.borderColor||'',});});this.tableEl.querySelectorAll('tr:not(:first-child):not(:last-child)').forEach((el)=>{const title=el.querySelector('th input').value||'';data.labels.push(title);el.querySelectorAll('td input').forEach((el,i)=>{data.datasets[i].data.push(el.value||0);if(this._isPieChart()){data.datasets[i].backgroundColor.push(el.dataset.backgroundColor||'');data.datasets[i].borderColor.push(el.dataset.borderColor||'');}});});return JSON.stringify(data);},_makeDeleteButton:function(...classes){const rmbuttonEl=options.buildElement('we-button',null,{classes:['o_we_text_danger','o_we_link','fa','fa-fw','fa-minus',...classes],});rmbuttonEl.title=classes.includes('o_we_matrix_remove_col')?_t("Remove Serie"):_t("Remove Row");const newEl=document.createElement('td');newEl.appendChild(rmbuttonEl);return newEl;},_addColumn:function(title,values,heardeBackgroundColor,headerBorderColor,cellBackgroundColors=[],cellBorderColors=[]){const firstRow=this.tableEl.querySelector('tr:first-child');const headerInput=this._makeCell('th',title,heardeBackgroundColor,headerBorderColor);firstRow.insertBefore(headerInput,firstRow.lastElementChild);this.tableEl.querySelectorAll('tr:not(:first-child):not(:last-child)').forEach((el,i)=>{const newCell=this._makeCell('td',values?values[i]:null,cellBackgroundColors[i]||this._randomColor(),cellBorderColors[i-1]);el.insertBefore(newCell,el.lastElementChild);});const lastRow=this.tableEl.querySelector('tr:last-child');const removeButton=this._makeDeleteButton('o_we_matrix_remove_col');lastRow.appendChild(removeButton);},_addRow:function(tilte){const trEl=document.createElement('tr');trEl.appendChild(this._makeCell('th',tilte));this.tableEl.querySelectorAll('tr:first-child input').forEach(()=>{trEl.appendChild(this._makeCell('td',null,this._randomColor()));});trEl.appendChild(this._makeDeleteButton('o_we_matrix_remove_row'));const tbody=this.tableEl.querySelector('tbody');tbody.insertBefore(trEl,tbody.lastElementChild);},_makeCell:function(tag,value,backgroundColor,borderColor){const newEl=document.createElement(tag);const contentEl=document.createElement('input');contentEl.type='text';contentEl.value=value||'';if(backgroundColor){contentEl.dataset.backgroundColor=backgroundColor;}
if(borderColor){contentEl.dataset.borderColor=borderColor;}
newEl.appendChild(contentEl);return newEl;},_displayRemoveColButton:function(colIndex){if(this._getColumnCount()>1){this._displayRemoveButton(colIndex,'o_we_matrix_remove_col');}},_displayRemoveRowButton:function(rowIndex){const rowCount=this.tableEl.rows.length-2;if(rowCount>1){this._displayRemoveButton(rowIndex,'o_we_matrix_remove_row');}},_displayRemoveButton:function(tdIndex,btnClass){const removeBtn=this.tableEl.querySelectorAll(`td we-button.${btnClass}`);removeBtn.forEach(el=>el.style.display='');const index=tdIndex<removeBtn.length?tdIndex:removeBtn.length-1;removeBtn[index].style.display='inline-block';},_isPieChart:function(){return['pie','doughnut'].includes(this.$target[0].dataset.type);},_getColumnCount:function(){return this.tableEl.rows[0].cells.length-2;},_setDefaultSelectedInput:function(){this.lastEditableSelectedInput=this.tableEl.querySelector('td input');if(this._isPieChart()){this.colorPaletteSelectedInput=this.lastEditableSelectedInput;}else{this.colorPaletteSelectedInput=this.tableEl.querySelector('th input');}},_randomColor:function(){return'#'+('00000'+(Math.random()*(1<<24)|0).toString(16)).slice(-6).toUpperCase();},_onGetCustomColors:function(ev){const data=JSON.parse(this.$target[0].dataset.data||'');let customColors=[];data.datasets.forEach(el=>{if(this._isPieChart()){customColors=customColors.concat(el.backgroundColor).concat(el.borderColor);}else{customColors.push(el.backgroundColor);customColors.push(el.borderColor);}});customColors=customColors.filter((el,i,array)=>{return!weUtils.getCSSVariableValue(el,this.style)&&array.indexOf(el)===i&&el!=='';});ev.data.onSuccess(customColors);},_onAddColumnClick:function(){const usedColor=Array.from(this.tableEl.querySelectorAll('tr:first-child input')).map(el=>el.dataset.backgroundColor);const color=this.themeArray.filter(el=>!usedColor.includes(el))[0]||this._randomColor();this._addColumn(null,null,color,color);this._reloadGraph().then(()=>{this._displayRemoveColButton();this.updateUI();});},_onAddRowClick:function(){this._addRow();this._reloadGraph().then(()=>{this._displayRemoveRowButton();this.updateUI();});},_onRemoveColumnClick:function(ev){const cell=ev.currentTarget.parentElement;const cellIndex=cell.cellIndex;this.tableEl.querySelectorAll('tr').forEach((el)=>{el.children[cellIndex].remove();});this._displayRemoveColButton(cellIndex-1);this._reloadGraph().then(()=>{this.updateUI();});},_onRemoveRowClick:function(ev){const row=ev.currentTarget.parentElement.parentElement;const rowIndex=row.rowIndex;row.remove();this._displayRemoveRowButton(rowIndex-1);this._reloadGraph().then(()=>{this.updateUI();});},_onMatrixInputFocusOut:function(ev){setTimeout(()=>{if(ev.currentTarget===document.activeElement){return;}
this._reloadGraph();});},_onMatrixInputFocus:function(ev){this.lastEditableSelectedInput=ev.target;const col=ev.target.parentElement.cellIndex;const row=ev.target.parentElement.parentElement.rowIndex;if(this._isPieChart()){this.colorPaletteSelectedInput=ev.target.parentNode.tagName==='TD'?ev.target:null;}else{this.colorPaletteSelectedInput=this.tableEl.querySelector(`tr:first-child th:nth-of-type(${col + 1}) input`);}
if(col>0){this._displayRemoveColButton(col-1);}
if(row>0){this._displayRemoveRowButton(row-1);}
this.updateUI();},});});;

/* /website/static/src/snippets/s_rating/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_rating_options',function(require){'use strict';const weWidgets=require('wysiwyg.widgets');const options=require('web_editor.snippets.options');options.registry.Rating=options.Class.extend({start:function(){this.iconType=this.$target[0].dataset.icon;this.faClassActiveCustomIcons=this.$target[0].dataset.activeCustomIcon||'';this.faClassInactiveCustomIcons=this.$target[0].dataset.inactiveCustomIcon||'';return this._super.apply(this,arguments);},setIcons:function(previewMode,widgetValue,params){this.iconType=widgetValue;this._renderIcons();this.$target[0].dataset.icon=widgetValue;delete this.$target[0].dataset.activeCustomIcon;delete this.$target[0].dataset.inactiveCustomIcon;},customIcon:async function(previewMode,widgetValue,params){return new Promise(resolve=>{const dialog=new weWidgets.MediaDialog(this,{noImages:true,noDocuments:true,noVideos:true,mediaWidth:1920},$('<i/>'));this._saving=false;dialog.on('save',this,function(attachments){this._saving=true;const customClass='fa '+attachments.className;const $activeIcons=this.$target.find('.s_rating_active_icons > i');const $inactiveIcons=this.$target.find('.s_rating_inactive_icons > i');const $icons=params.customActiveIcon==='true'?$activeIcons:$inactiveIcons;$icons.removeClass().addClass(customClass);this.faClassActiveCustomIcons=$activeIcons.length>0?$activeIcons.attr('class'):customClass;this.faClassInactiveCustomIcons=$inactiveIcons.length>0?$inactiveIcons.attr('class'):customClass;this.$target[0].dataset.activeCustomIcon=this.faClassActiveCustomIcons;this.$target[0].dataset.inactiveCustomIcon=this.faClassInactiveCustomIcons;this.$target[0].dataset.icon='custom';this.iconType='custom';resolve();});dialog.on('closed',this,function(){if(!this._saving){resolve();}});dialog.open();});},activeIconsNumber:function(previewMode,widgetValue,params){this.nbActiveIcons=parseInt(widgetValue);this._createIcons();},totalIconsNumber:function(previewMode,widgetValue,params){this.nbTotalIcons=Math.max(parseInt(widgetValue),1);this._createIcons();},_computeWidgetState:function(methodName,params){switch(methodName){case'setIcons':{return this.$target[0].dataset.icon;}
case'activeIconsNumber':{this.nbActiveIcons=this.$target.find('.s_rating_active_icons > i').length;return this.nbActiveIcons;}
case'totalIconsNumber':{this.nbTotalIcons=this.$target.find('.s_rating_icons i').length;return this.nbTotalIcons;}}
return this._super(...arguments);},_createIcons:function(){const $activeIcons=this.$target.find('.s_rating_active_icons');const $inactiveIcons=this.$target.find('.s_rating_inactive_icons');this.$target.find('.s_rating_icons i').remove();for(let i=0;i<this.nbTotalIcons;i++){if(i<this.nbActiveIcons){$activeIcons.append('<i/> ');}else{$inactiveIcons.append('<i/> ');}}
this._renderIcons();},_renderIcons:function(){const icons={'fa-star':'fa-star-o','fa-thumbs-up':'fa-thumbs-o-up','fa-circle':'fa-circle-o','fa-square':'fa-square-o','fa-heart':'fa-heart-o'};const faClassActiveIcons=(this.iconType==="custom")?this.faClassActiveCustomIcons:'fa '+this.iconType;const faClassInactiveIcons=(this.iconType==="custom")?this.faClassInactiveCustomIcons:'fa '+icons[this.iconType];const $activeIcons=this.$target.find('.s_rating_active_icons > i');const $inactiveIcons=this.$target.find('.s_rating_inactive_icons > i');$activeIcons.removeClass().addClass(faClassActiveIcons);$inactiveIcons.removeClass().addClass(faClassInactiveIcons);},});});;

/* /website/static/src/snippets/s_tabs/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_tabs_options',function(require){'use strict';const options=require('web_editor.snippets.options');options.registry.NavTabs=options.registry.MultipleItems.extend({isTopOption:true,start:function(){this._findLinksAndPanes();return this._super.apply(this,arguments);},onBuilt:function(){this._generateUniqueIDs();},onClone:function(){this._generateUniqueIDs();},_computeWidgetVisibility:async function(widgetName,params){if(widgetName==='remove_tab_opt'){return(this.$tabPanes.length>2);}
return this._super(...arguments);},_findLinksAndPanes:function(){this.$navLinks=this.$target.find('.nav:first .nav-link');this.$tabPanes=this.$target.find('.tab-content:first .tab-pane');},_generateUniqueIDs:function(){for(var i=0;i<this.$navLinks.length;i++){var id=_.now()+'_'+_.uniqueId();var idLink='nav_tabs_link_'+id;var idContent='nav_tabs_content_'+id;this.$navLinks.eq(i).attr({'id':idLink,'href':'#'+idContent,'aria-controls':idContent,});this.$tabPanes.eq(i).attr({'id':idContent,'aria-labelledby':idLink,});}},_addItemCallback($target){$target.removeClass('active show');const $targetNavItem=this.$(`.nav-item a[href="#${$target.attr('id')}"]`).removeClass('active show').parent();const $navLink=$targetNavItem.clone().insertAfter($targetNavItem).find('.nav-link');this._findLinksAndPanes();this._generateUniqueIDs();$navLink.tab('show');},_removeItemCallback($target){const $targetNavLink=this.$(`.nav-item a[href="#${$target.attr('id')}"]`);const $navLinkToShow=this.$navLinks.eq((this.$navLinks.index($targetNavLink)+1)%this.$navLinks.length);$targetNavLink.parent().remove();this._findLinksAndPanes();$navLinkToShow.tab('show');},});options.registry.NavTabsStyle=options.Class.extend({setStyle:function(previewMode,widgetValue,params){const $nav=this.$target.find('.s_tabs_nav:first .nav');const isPills=widgetValue==='pills';$nav.toggleClass('nav-tabs card-header-tabs',!isPills);$nav.toggleClass('nav-pills',isPills);this.$target.find('.s_tabs_nav:first').toggleClass('card-header',!isPills).toggleClass('mb-3',isPills);this.$target.toggleClass('card',!isPills);this.$target.find('.s_tabs_content:first').toggleClass('card-body',!isPills);},setDirection:function(previewMode,widgetValue,params){const isVertical=widgetValue==='vertical';this.$target.toggleClass('row s_col_no_resize s_col_no_bgcolor',isVertical);this.$target.find('.s_tabs_nav:first .nav').toggleClass('flex-column',isVertical);this.$target.find('.s_tabs_nav:first > .nav-link').toggleClass('py-2',isVertical);this.$target.find('.s_tabs_nav:first').toggleClass('col-md-3',isVertical);this.$target.find('.s_tabs_content:first').toggleClass('col-md-9',isVertical);},_computeWidgetState:function(methodName,params){switch(methodName){case'setStyle':return this.$target.find('.s_tabs_nav:first .nav').hasClass('nav-pills')?'pills':'tabs';case'setDirection':return this.$target.find('.s_tabs_nav:first .nav').hasClass('flex-column')?'vertical':'horizontal';}
return this._super(...arguments);},});});;

/* /website/static/src/snippets/s_progress_bar/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_progress_bar_options',function(require){'use strict';const core=require('web.core');const utils=require('web.utils');const options=require('web_editor.snippets.options');const _t=core._t;options.registry.progress=options.Class.extend({display:function(previewMode,widgetValue,params){if(this.$target.hasClass('progress')){this.$target.removeClass('progress');this.$target.find('.progress-bar').wrap($('<div/>',{class:'progress',}));this.$target.find('.progress-bar span').addClass('s_progress_bar_text');}
let $text=this.$target.find('.s_progress_bar_text');if(!$text.length){$text=$('<span/>').addClass('s_progress_bar_text').html(_t('80% Development'));}
if(widgetValue==='inline'){$text.appendTo(this.$target.find('.progress-bar'));}else{$text.insertBefore(this.$target.find('.progress'));}},progressBarValue:function(previewMode,widgetValue,params){let value=parseInt(widgetValue);value=utils.confine(value,0,100);const $progressBar=this.$target.find('.progress-bar');const $progressBarText=this.$target.find('.s_progress_bar_text');$progressBarText.text($progressBarText.text().replace(/[0-9]+%/,value+'%'));$progressBar.attr("aria-valuenow",value);$progressBar.css("width",value+"%");},_computeWidgetState:function(methodName,params){switch(methodName){case'display':{const isInline=this.$target.find('.s_progress_bar_text').parent('.progress-bar').length;return isInline?'inline':'below';}
case'progressBarValue':{return this.$target.find('.progress-bar').attr('aria-valuenow')+'%';}}
return this._super(...arguments);},});});;

/* /website/static/src/snippets/s_blockquote/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_blockquote_options',function(require){'use strict';const options=require('web_editor.snippets.options');options.registry.Blockquote=options.Class.extend({display:function(previewMode,widgetValue,params){this.$target.find('.s_blockquote_avatar').toggleClass('d-none',widgetValue!=='classic');const $blockquote=this.$target.find('.s_blockquote_content');if(widgetValue==='cover'){$blockquote.css({"background-image":"url('/web/image/website.s_blockquote_cover_default_image')"});$blockquote.addClass('oe_img_bg o_bg_img_center');if(!$blockquote.find('.o_we_bg_filter').length){const bgFilterEl=document.createElement('div');bgFilterEl.classList.add('o_we_bg_filter','bg-white-50');$blockquote.prepend(bgFilterEl);}}else{$blockquote.css({"background-image":""});$blockquote.css({"background-position":""});$blockquote.removeClass('oe_img_bg o_bg_img_center');$blockquote.find('.o_we_bg_filter').remove();$blockquote.find('.s_blockquote_filter').contents().unwrap();}
this.$target.find('.s_blockquote_icon').toggleClass('d-none',widgetValue==='minimalist');this.$target.find('footer').toggleClass('d-none',widgetValue==='minimalist');},});});;

/* /website/static/src/snippets/s_showcase/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_showcase_options',function(require){'use strict';const options=require('web_editor.snippets.options');options.registry.Showcase=options.Class.extend({onMove:function(){const $showcaseCol=this.$target.parent().closest('.row > div');const isLeftCol=$showcaseCol.index()<=0;const $title=this.$target.children('.s_showcase_title');$title.toggleClass('flex-lg-row-reverse',isLeftCol);$showcaseCol.find('.s_showcase_icon.ml-3').removeClass('ml-3').addClass('ml-lg-3');$title.find('.s_showcase_icon').toggleClass('mr-lg-0 ml-lg-3',isLeftCol);},});});;

/* /website/static/src/snippets/s_table_of_content/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_table_of_content_options',function(require){'use strict';const options=require('web_editor.snippets.options');options.registry.TableOfContent=options.Class.extend({start:function(){this.targetedElements='h1, h2';const $headings=this.$target.find(this.targetedElements);if($headings.length>0){this._generateNav();}
const targetNode=this.$target.find('.s_table_of_content_main')[0];const config={attributes:false,childList:true,subtree:true,characterData:true};this.observer=new MutationObserver(()=>this._generateNav());this.observer.observe(targetNode,config);return this._super(...arguments);},onClone:function(){this._generateNav();},_generateNav:function(ev){this.options.wysiwyg&&this.options.wysiwyg.odooEditor.unbreakableStepUnactive();const $nav=this.$target.find('.s_table_of_content_navbar');const $headings=this.$target.find(this.targetedElements);$nav.empty();_.each($headings,el=>{const $el=$(el);const id='table_of_content_heading_'+_.now()+'_'+_.uniqueId();$('<a>').attr('href',"#"+id).addClass('table_of_content_link list-group-item list-group-item-action py-2 border-0 rounded-0').text($el.text()).appendTo($nav);$el.attr('id',id);$el[0].dataset.anchor='true';});$nav.find('a:first').addClass('active');},});options.registry.TableOfContentNavbar=options.Class.extend({navbarPosition:function(previewMode,widgetValue,params){const $navbar=this.$target;const $mainContent=this.$target.parent().find('.s_table_of_content_main');if(widgetValue==='top'||widgetValue==='left'){$navbar.prev().before($navbar);}
if(widgetValue==='left'||widgetValue==='right'){$navbar.removeClass('s_table_of_content_horizontal_navbar col-lg-12').addClass('s_table_of_content_vertical_navbar col-lg-3');$mainContent.removeClass('col-lg-12').addClass('col-lg-9');$navbar.find('.s_table_of_content_navbar').removeClass('list-group-horizontal-md');}
if(widgetValue==='right'){$navbar.next().after($navbar);}
if(widgetValue==='top'){$navbar.removeClass('s_table_of_content_vertical_navbar col-lg-3').addClass('s_table_of_content_horizontal_navbar col-lg-12');$navbar.find('.s_table_of_content_navbar').addClass('list-group-horizontal-md');$mainContent.removeClass('col-lg-9').addClass('col-lg-12');}},_computeWidgetState:function(methodName,params){switch(methodName){case'navbarPosition':{const $navbar=this.$target;if($navbar.hasClass('s_table_of_content_horizontal_navbar')){return'top';}else{const $mainContent=$navbar.parent().find('.s_table_of_content_main');return $navbar.prev().is($mainContent)===true?'right':'left';}}}
return this._super(...arguments);},});options.registry.TableOfContentMainColumns=options.Class.extend({forceNoDeleteButton:true,start:function(){const leftPanelEl=this.$overlay.data('$optionsSection')[0];leftPanelEl.querySelector('.oe_snippet_clone').classList.add('d-none');return this._super.apply(this,arguments);},});});;

/* /website/static/src/snippets/s_timeline/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_timeline_options',function(require){'use strict';const options=require('web_editor.snippets.options');options.registry.Timeline=options.Class.extend({displayOverlayOptions:true,start:function(){var $buttons=this.$el.find('we-button.o_we_overlay_opt');var $overlayArea=this.$overlay.find('.o_overlay_options_wrap');$overlayArea.append($buttons);return this._super(...arguments);},timelineCard:function(previewMode,widgetValue,params){const $timelineRow=this.$target.closest('.s_timeline_row');$timelineRow.toggleClass('flex-row-reverse flex-row');},});});;

/* /website/static/src/snippets/s_media_list/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_media_list_options',function(require){'use strict';const options=require('web_editor.snippets.options');options.registry.MediaItemLayout=options.Class.extend({layout:function(previewMode,widgetValue,params){const $image=this.$target.find('.s_media_list_img_wrapper');const $content=this.$target.find('.s_media_list_body');for(const possibleValue of params.possibleValues){$image.removeClass(`col-lg-${possibleValue}`);$content.removeClass(`col-lg-${12 - possibleValue}`);}
$image.addClass(`col-lg-${widgetValue}`);$content.addClass(`col-lg-${12 - widgetValue}`);},_computeWidgetState(methodName,params){switch(methodName){case'layout':{const $image=this.$target.find('.s_media_list_img_wrapper');for(const possibleValue of params.possibleValues){if($image.hasClass(`col-lg-${possibleValue}`)){return possibleValue;}}}}
return this._super(...arguments);},});});;

/* /website/static/src/snippets/s_google_map/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('options.s_google_map_options',function(require){'use strict';const{_t}=require('web.core');const options=require('web_editor.snippets.options');options.registry.GoogleMap=options.Class.extend({resetMapColor(previewMode,widgetValue,params){this.$target[0].dataset.mapColor='';},setFormattedAddress(previewMode,widgetValue,params){this.$target[0].dataset.pinAddress=params.gmapPlace.formatted_address;},async showDescription(previewMode,widgetValue,params){const descriptionEl=this.$target[0].querySelector('.description');if(widgetValue&&!descriptionEl){this.$target.append($(`
                <div class="description">
                    <font>${_t('Visit us:')}</font>
                    <span>${_t('Our office is located in the northeast of Brussels. TEL (555) 432 2365')}</span>
                </div>`));}else if(!widgetValue&&descriptionEl){descriptionEl.remove();}},_computeWidgetState(methodName,params){if(methodName==='showDescription'){return this.$target[0].querySelector('.description')?'true':'';}
return this._super(...arguments);},});});;

/* /website/static/src/snippets/s_map/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('@website/snippets/s_map/options',async function(require){'use strict';let __exports={};const{_t}=require('web.core');const options=require('web_editor.snippets.options');options.registry.Map=options.Class.extend({onBuilt(){this._updateSource();},async selectDataAttribute(previewMode,widgetValue,params){await this._super(...arguments);if(['mapAddress','mapType','mapZoom'].includes(params.attributeName)){this._updateSource();}},async showDescription(previewMode,widgetValue,params){const descriptionEl=this.$target[0].querySelector('.description');if(widgetValue&&!descriptionEl){this.$target.append($(`
                <div class="description">
                    <font>${_t('Visit us:')}</font>
                    <span>${_t('Our office is open Monday â€“ Friday 8:30 a.m. â€“ 4:00 p.m.')}</span>
                </div>`));}else if(!widgetValue&&descriptionEl){descriptionEl.remove();}},_computeWidgetState(methodName,params){if(methodName==='showDescription'){return!!this.$target[0].querySelector('.description');}
return this._super(...arguments);},_updateSource(){const dataset=this.$target[0].dataset;const $embedded=this.$target.find('.s_map_embedded');const $info=this.$target.find('.missing_option_warning');if(dataset.mapAddress){const url='https://maps.google.com/maps?q='+encodeURIComponent(dataset.mapAddress)
+'&t='+encodeURIComponent(dataset.mapType)
+'&z='+encodeURIComponent(dataset.mapZoom)
+'&ie=UTF8&iwloc=&output=embed';if(url!==$embedded.attr('src')){$embedded.attr('src',url);}
$embedded.removeClass('d-none');$info.addClass('d-none');}else{$embedded.attr('src','about:blank');$embedded.addClass('d-none');$info.removeClass('d-none');}},});__exports[Symbol.for("default")]={Map:options.registry.Map,};return __exports;});;

/* /website/static/src/snippets/s_dynamic_snippet/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_dynamic_snippet_options',function(require){'use strict';const options=require('web_editor.snippets.options');const dynamicSnippetOptions=options.Class.extend({init:function(){this._super.apply(this,arguments);this.modelNameFilter=undefined;this.contextualFilterDomain=[];this.dynamicFilters={};this.currentModelName=undefined;this.dynamicFilterTemplates={};this.isOptionDefault={};},onBuilt:function(){this._setOptionsDefaultValues();},selectDataAttribute:function(previewMode,widgetValue,params){this._super.apply(this,arguments);if(params.attributeName==='filterId'&&previewMode===false){const filter=this.dynamicFilters[parseInt(widgetValue)];this.$target.get(0).dataset.numberOfRecords=filter.limit;this._filterUpdated(filter);}
if(params.attributeName==='templateKey'&&previewMode===false){this._templateUpdated(widgetValue,params.activeValue);}
if(params.attributeName==='numberOfRecords'&&previewMode===false){const dataSet=this.$target.get(0).dataset;if(dataSet.numberOfElements>dataSet.numberOfRecords){dataSet.numberOfElements=dataSet.numberOfRecords;}
if(dataSet.numberOfElementsSmallDevices>dataSet.numberOfRecords){dataSet.numberOfElementsSmallDevices=dataSet.numberOfRecords;}}},async updateUI(){if(this.rerender){this.rerender=false;await this._rerenderXML();return;}
await this._super(...arguments);},async updateUIVisibility(){await this._super(...arguments);const template=this._getCurrentTemplate();const groupingMessage=this.el.querySelector('.o_grouping_message');groupingMessage.classList.toggle('d-none',template&&!!template.numOfEl&&!!template.numOfElSm);},_getCurrentTemplate:function(){return this.dynamicFilterTemplates[this.$target.get(0).dataset['templateKey']];},_getTemplateClass:function(templateKey){return templateKey.replace(/.*\.dynamic_filter_template_/,"s_");},_computeWidgetVisibility:function(widgetName,params){if(widgetName==='filter_opt'){return Object.keys(this.dynamicFilters).length!==1;}
if(widgetName==='number_of_elements_opt'){const template=this._getCurrentTemplate();return template&&!template.numOfEl;}
if(widgetName==='number_of_elements_small_devices_opt'){const template=this._getCurrentTemplate();return template&&!template.numOfElSm;}
if(widgetName==='number_of_records_opt'){const template=this._getCurrentTemplate();return template&&!template.numOfElFetch;}
return this._super.apply(this,arguments);},_refreshPublicWidgets:function(){return this._super.apply(this,arguments).then(()=>{const template=this._getCurrentTemplate();this.$target.find('.missing_option_warning').toggleClass('d-none',!!template);});},_fetchDynamicFilters:function(){return this._rpc({route:'/website/snippet/options_filters',params:{model_name:this.modelNameFilter,search_domain:this.contextualFilterDomain,}});},_fetchDynamicFilterTemplates:function(){const filter=this.dynamicFilters[this.$target.get(0).dataset['filterId']];return filter?this._rpc({route:'/website/snippet/filter_templates',params:{filter_name:filter.model_name.replaceAll('.','_'),}}):[];},_renderCustomXML:async function(uiFragment){await this._renderDynamicFiltersSelector(uiFragment);await this._renderDynamicFilterTemplatesSelector(uiFragment);},_renderDynamicFiltersSelector:async function(uiFragment){if(!Object.keys(this.dynamicFilters).length){const dynamicFilters=await this._fetchDynamicFilters();for(let index in dynamicFilters){this.dynamicFilters[dynamicFilters[index].id]=dynamicFilters[index];}
if(dynamicFilters.length>0){const selectedFilterId=this.$target.get(0).dataset['filterId'];if(!this.dynamicFilters[selectedFilterId]){this.$target.get(0).dataset['filterId']=dynamicFilters[0].id;this.isOptionDefault['filterId']=true;}}}
const filtersSelectorEl=uiFragment.querySelector('[data-name="filter_opt"]');return this._renderSelectUserValueWidgetButtons(filtersSelectorEl,this.dynamicFilters);},_renderSelectUserValueWidgetButtons:async function(selectUserValueWidgetElement,data){for(let id in data){const button=document.createElement('we-button');button.dataset.selectDataAttribute=id;button.innerHTML=data[id].name;selectUserValueWidgetElement.appendChild(button);}},_renderDynamicFilterTemplatesSelector:async function(uiFragment){const dynamicFilterTemplates=await this._fetchDynamicFilterTemplates();this.dynamicFilterTemplates={};for(let index in dynamicFilterTemplates){this.dynamicFilterTemplates[dynamicFilterTemplates[index].key]=dynamicFilterTemplates[index];}
if(dynamicFilterTemplates.length>0){const selectedTemplateId=this.$target.get(0).dataset['templateKey'];if(!this.dynamicFilterTemplates[selectedTemplateId]){this.$target.get(0).dataset['templateKey']=dynamicFilterTemplates[0].key;this.isOptionDefault['templateKey']=true;setTimeout(()=>{this._templateUpdated(dynamicFilterTemplates[0].key,selectedTemplateId);this._refreshPublicWidgets();});}}else{this._refreshPublicWidgets();}
const templatesSelectorEl=uiFragment.querySelector('[data-name="template_opt"]');return this._renderSelectUserValueWidgetButtons(templatesSelectorEl,this.dynamicFilterTemplates);},_setOptionsDefaultValues:function(){this.options.wysiwyg.odooEditor.observerUnactive();this._setOptionValue('numberOfElements',4);this._setOptionValue('numberOfElementsSmallDevices',1);const filterKeys=this.$el.find("we-select[data-attribute-name='filterId'] we-selection-items we-button");if(filterKeys.length>0){this._setOptionValue('numberOfRecords',this.dynamicFilters[Object.keys(this.dynamicFilters)[0]].limit);}
const filter=this.dynamicFilters[this.$target.get(0).dataset['filterId']];this._filterUpdated(filter);this.options.wysiwyg.odooEditor.observerActive();},_filterUpdated:function(filter){if(filter&&this.currentModelName!==filter.model_name){this.currentModelName=filter.model_name;this.rerender=true;}},_templateUpdated:function(newTemplate,oldTemplate){if(oldTemplate){this.$target.removeClass(this._getTemplateClass(oldTemplate));}
this.$target.addClass(this._getTemplateClass(newTemplate));const template=this.dynamicFilterTemplates[newTemplate];if(template.numOfEl){this.$target[0].dataset.numberOfElements=template.numOfEl;}
if(template.numOfElSm){this.$target[0].dataset.numberOfElementsSmallDevices=template.numOfElSm;}
if(template.numOfElFetch){this.$target[0].dataset.numberOfRecords=template.numOfElFetch;}},_setOptionValue:function(optionName,value){const selectedTemplateId=this.$target.get(0).dataset['templateKey'];if(this.$target.get(0).dataset[optionName]===undefined||this.isOptionDefault[optionName]){this.$target.get(0).dataset[optionName]=value;this.isOptionDefault[optionName]=false;}
if(optionName==='templateKey'){this._templateUpdated(value,selectedTemplateId);}},});options.registry.dynamic_snippet=dynamicSnippetOptions;return dynamicSnippetOptions;});;

/* /website/static/src/snippets/s_dynamic_snippet_carousel/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.s_dynamic_snippet_carousel_options',function(require){'use strict';const options=require('web_editor.snippets.options');const s_dynamic_snippet_options=require('website.s_dynamic_snippet_options');const dynamicSnippetCarouselOptions=s_dynamic_snippet_options.extend({_setOptionsDefaultValues:function(){this._super.apply(this,arguments);this._setOptionValue('carouselInterval','5000');}});options.registry.dynamic_snippet_carousel=dynamicSnippetCarouselOptions;return dynamicSnippetCarouselOptions;});;

/* /website/static/src/snippets/s_embed_code/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('@website/snippets/s_embed_code/options',async function(require){'use strict';let __exports={};const Dialog=require('web.Dialog');const core=require('web.core');const options=require('web_editor.snippets.options');const _t=core._t;options.registry.EmbedCode=options.Class.extend({async editCode(){const $container=this.$target.find('.s_embed_code_embedded');const code=$container.html().trim();await this._loadLibs({jsLibs:['/web/static/lib/ace/ace.js','/web/static/lib/ace/mode-xml.js','/web/static/lib/ace/mode-qweb.js',],});await new Promise(resolve=>{const $content=$(core.qweb.render('website.custom_code_dialog_content'));const aceEditor=this._renderAceEditor($content.find('.o_ace_editor_container')[0],code||'');const dialog=new Dialog(this,{title:_t("Edit embedded code"),$content,buttons:[{text:_t("Save"),classes:'btn-primary',click:async()=>{$container[0].innerHTML=aceEditor.getValue();},close:true,},{text:_t("Discard"),close:true,},],});dialog.on('closed',this,resolve);dialog.open();});},_renderAceEditor(node,content){const aceEditor=window.ace.edit(node);aceEditor.setTheme('ace/theme/monokai');aceEditor.setValue(content,1);aceEditor.setOptions({minLines:20,maxLines:Infinity,showPrintMargin:false,});aceEditor.renderer.setOptions({highlightGutterLine:true,showInvisibles:true,fontSize:14,});const aceSession=aceEditor.getSession();aceSession.setOptions({mode:"ace/mode/xml",useWorker:false,});return aceEditor;},});__exports[Symbol.for("default")]={EmbedCode:options.registry.EmbedCode,};return __exports;});;

/* /website/static/src/snippets/s_website_form/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.form_editor',function(require){'use strict';const core=require('web.core');const FormEditorRegistry=require('website.form_editor_registry');const options=require('web_editor.snippets.options');const Dialog=require('web.Dialog');const dom=require('web.dom');require('website.editor.snippets.options');const qweb=core.qweb;const _t=core._t;const FormEditor=options.Class.extend({xmlDependencies:['/website/static/src/xml/website_form_editor.xml','/google_recaptcha/static/src/xml/recaptcha.xml',],_fetchFieldRecords:async function(field){field.required=field.required?1:null;if(field.records){return field.records;}
if(field.type==='selection'){field.records=field.selection.map(el=>({id:el[0],display_name:el[1],}));}else if(field.relation&&field.relation!=='ir.attachment'){field.records=await this._rpc({model:field.relation,method:'search_read',args:[field.domain,['display_name']],});}
return field.records;},_generateUniqueID(){return Math.random().toString(36).substring(2,15);},_getCustomField:function(type,name){return{name:name,string:name,custom:true,type:type,records:[{id:_t('Option 1'),display_name:_t('Option 1'),},{id:_t('Option 2'),display_name:_t('Option 2'),},{id:_t('Option 3'),display_name:_t('Option 3'),}],};},_getDefaultFormat:function(){return{labelWidth:this.$target[0].querySelector('.s_website_form_label').style.width,labelPosition:'left',multiPosition:'horizontal',requiredMark:this._isRequiredMark(),optionalMark:this._isOptionalMark(),mark:this._getMark(),};},_getMark:function(){return this.$target[0].dataset.mark;},_isOptionalMark:function(){return this.$target[0].classList.contains('o_mark_optional');},_isRequiredMark:function(){return this.$target[0].classList.contains('o_mark_required');},_renderField:function(field,resetId=false){if(!field.id){field.id=this._generateUniqueID();}
const template=document.createElement('template');template.innerHTML=qweb.render("website.form_field_"+field.type,{field:field}).trim();if(field.description&&field.description!==true){$(template.content.querySelector('.s_website_form_field_description')).replaceWith(field.description);}
template.content.querySelectorAll('input.datetimepicker-input').forEach(el=>el.value=field.propertyValue);return template.content.firstElementChild;},});const FieldEditor=FormEditor.extend({VISIBILITY_DATASET:['visibilityDependency','visibilityCondition','visibilityComparator','visibilityBetween'],init:function(){this._super.apply(this,arguments);this.formEl=this.$target[0].closest('form');},_getActiveField:function(noRecords){let field;const labelText=this.$target.find('.s_website_form_label_content').text();if(this._isFieldCustom()){field=this._getCustomField(this.$target[0].dataset.type,labelText);}else{field=Object.assign({},this.fields[this._getFieldName()]);field.string=labelText;}
if(!noRecords){field.records=this._getListItems();}
this._setActiveProperties(field);return field;},_getFieldFormat:function(){let requiredMark,optionalMark;const mark=this.$target[0].querySelector('.s_website_form_mark');if(mark){requiredMark=this._isFieldRequired();optionalMark=!requiredMark;}
const multipleInput=this._getMultipleInputs();const format={labelPosition:this._getLabelPosition(),labelWidth:this.$target[0].querySelector('.s_website_form_label').style.width,multiPosition:multipleInput&&multipleInput.dataset.display||'horizontal',col:[...this.$target[0].classList].filter(el=>el.match(/^col-/g)).join(' '),requiredMark:requiredMark,optionalMark:optionalMark,mark:mark&&mark.textContent,};return format;},_getFieldName:function(){const multipleName=this.$target[0].querySelector('.s_website_form_multiple');return multipleName?multipleName.dataset.name:this.$target[0].querySelector('.s_website_form_input').name;},_getFieldType:function(){return this.$target[0].dataset.type;},_getLabelPosition:function(){const label=this.$target[0].querySelector('.s_website_form_label');if(this.$target[0].querySelector('.row:not(.s_website_form_multiple)')){return label.classList.contains('text-right')?'right':'left';}else{return label.classList.contains('d-none')?'none':'top';}},_getMultipleInputs:function(){return this.$target[0].querySelector('.s_website_form_multiple');},_isFieldCustom:function(){return!!this.$target[0].classList.contains('s_website_form_custom');},_isFieldRequired:function(){const classList=this.$target[0].classList;return classList.contains('s_website_form_required')||classList.contains('s_website_form_model_required');},_setActiveProperties(field){const classList=this.$target[0].classList;const textarea=this.$target[0].querySelector('textarea');const input=this.$target[0].querySelector('input[type="text"], input[type="email"], input[type="number"], input[type="tel"], input[type="url"], textarea');const description=this.$target[0].querySelector('.s_website_form_field_description');field.placeholder=input&&input.placeholder;if(input){field.value=input.getAttribute('value')||input.value;}else if(field.type==='boolean'){field.value=!!this.$target[0].querySelector('input[type="checkbox"][checked]');}
field.propertyValue=input&&input.value;field.description=description&&description.outerHTML;field.rows=textarea&&textarea.rows;field.required=classList.contains('s_website_form_required');field.modelRequired=classList.contains('s_website_form_model_required');field.hidden=classList.contains('s_website_form_field_hidden');field.formatInfo=this._getFieldFormat();},});options.registry.WebsiteFormEditor=FormEditor.extend({events:_.extend({},options.Class.prototype.events||{},{'click .toggle-edit-message':'_onToggleEndMessageClick',}),willStart:async function(){const _super=this._super.bind(this);this.modelCantChange=this.$target.attr('hide-change-model')!==undefined;if(this.modelCantChange){return _super(...arguments);}
this.models=await this._rpc({model:"ir.model",method:"search_read",args:[[['website_form_access','=',true]],['id','model','name','website_form_label','website_form_key']],});const targetModelName=this.$target[0].dataset.model_name||'mail.mail';this.activeForm=_.findWhere(this.models,{model:targetModelName});this.selectActionEl=document.createElement('we-select');this.selectActionEl.setAttribute('string','Action');this.selectActionEl.dataset.noPreview='true';this.models.forEach(el=>{const option=document.createElement('we-button');option.textContent=el.website_form_label;option.dataset.selectAction=el.id;this.selectActionEl.append(option);});return _super(...arguments);},start:function(){const proms=[this._super(...arguments)];this.$target.attr('contentEditable',false);this.$target.find('.s_website_form_send, .s_website_form_field_description, .s_website_form_recaptcha').attr('contentEditable',true);this.$message=this.$target.parent().find('.s_website_form_end_message');this.showEndMessage=false;if(!this.$target[0].dataset.model_name){proms.push(this._applyFormModel());}
return Promise.all(proms);},cleanForSave:function(){const model=this.$target[0].dataset.model_name;if(model){const fields=[...this.$target[0].querySelectorAll('.s_website_form_field:not(.s_website_form_custom) .s_website_form_input')].map(el=>el.name);if(fields.length){this._rpc({model:'ir.model.fields',method:'formbuilder_whitelist',args:[model,_.uniq(fields)],});}}
if(this.$message.length){this.$target.removeClass('d-none');this.$message.addClass("d-none");}
this.$target.find('input[name],textarea[name]').each(function(){var original=$(this).data('website_form_original_default_value');if(original!==undefined&&$(this).val()===original){$(this).val('').removeAttr('value');}});},updateUI:async function(){if(this.rerender){this.rerender=false;await this._rerenderXML();return;}
await this._super.apply(this,arguments);this.updateUIEndMessage();},updateUIEndMessage:function(){this.$target.toggleClass("d-none",this.showEndMessage);this.$message.toggleClass("d-none",!this.showEndMessage);this.$el.find(".toggle-edit-message").toggleClass('text-primary',this.showEndMessage);},notify:function(name,data){this._super(...arguments);if(name==='field_mark'){this._setLabelsMark();}else if(name==='add_field'){const field=this._getCustomField('char','Custom Text');field.formatInfo=data.formatInfo;field.formatInfo.requiredMark=this._isRequiredMark();field.formatInfo.optionalMark=this._isOptionalMark();field.formatInfo.mark=this._getMark();const fieldEl=this._renderField(field);data.$target.after(fieldEl);this.trigger_up('activate_snippet',{$snippet:$(fieldEl),});}},addActionField:function(previewMode,value,params){const fieldName=params.fieldName;if(params.isSelect==='true'){value=parseInt(value);}
this._addHiddenField(value,fieldName);},promptSaveRedirect:function(name,value,widgetValue){return new Promise((resolve,reject)=>{const message=_t("Would you like to save before being redirected? Unsaved changes will be discarded.");Dialog.confirm(this,message,{cancel_callback:()=>resolve(),buttons:[{text:_t("Save"),classes:'btn-primary',click:(ev)=>{const restore=dom.addButtonLoadingEffect(ev.currentTarget);this.trigger_up('request_save',{reload:false,onSuccess:()=>{this._redirectToAction(value);},onFailure:()=>{restore();this.displayNotification({message:_t("Something went wrong."),type:'danger',sticky:true,});reject();},});resolve();},},{text:_t("Discard"),click:(ev)=>{dom.addButtonLoadingEffect(ev.currentTarget);this._redirectToAction(value);},},{text:_t("Cancel"),close:true,click:()=>resolve(),},],});});},onSuccess:function(previewMode,value,params){this.$target[0].dataset.successMode=value;if(value==='message'){if(!this.$message.length){this.$message=$(qweb.render('website.s_website_form_end_message'));}
this.$target.after(this.$message);}else{this.showEndMessage=false;this.$message.remove();}},selectAction:async function(previewMode,value,params){if(this.modelCantChange){return;}
await this._applyFormModel(parseInt(value));this.rerender=true;},selectClass:function(previewMode,value,params){this._super(...arguments);if(params.name==='field_mark_select'){this._setLabelsMark();}},setMark:function(previewMode,value,params){this.$target[0].dataset.mark=value.trim();this._setLabelsMark();},toggleRecaptchaLegal:function(previewMode,value,params){const recaptchaLegalEl=this.$target[0].querySelector('.s_website_form_recaptcha');if(recaptchaLegalEl){recaptchaLegalEl.remove();}else{const template=document.createElement('template');const labelWidth=this.$target[0].querySelector('.s_website_form_label').style.width;$(template).html(qweb.render("website.s_website_form_recaptcha_legal",{labelWidth:labelWidth}));const legal=template.content.firstElementChild;legal.setAttribute('contentEditable',true);this.$target.find('.s_website_form_submit').before(legal);}},_computeWidgetState:function(methodName,params){switch(methodName){case'selectAction':return this.activeForm.id;case'addActionField':{const value=this.$target.find(`.s_website_form_dnone input[name="${params.fieldName}"]`).val();if(value){return value;}else{return params.isSelect?'0':'';}}
case'onSuccess':return this.$target[0].dataset.successMode;case'setMark':return this._getMark();case'toggleRecaptchaLegal':return!this.$target[0].querySelector('.s_website_form_recaptcha')||'';}
return this._super(...arguments);},_renderCustomXML:function(uiFragment){if(this.modelCantChange){return;}
const firstOption=uiFragment.childNodes[0];uiFragment.insertBefore(this.selectActionEl.cloneNode(true),firstOption);const formKey=this.activeForm.website_form_key;const formInfo=FormEditorRegistry.get(formKey);if(!formInfo||!formInfo.fields){return;}
const proms=formInfo.fields.map(field=>this._fetchFieldRecords(field));return Promise.all(proms).then(()=>{formInfo.fields.forEach(field=>{let option;switch(field.type){case'many2one':option=this._buildSelect(field);break;case'char':option=this._buildInput(field);break;}
if(field.required){const currentValue=this.$target.find(`.s_website_form_dnone input[name="${field.name}"]`).val();const defaultValue=field.defaultValue||field.records[0].id;this._addHiddenField(currentValue||defaultValue,field.name);}
uiFragment.insertBefore(option,firstOption);});});},_addHiddenField:function(value,fieldName){this.$target.find(`.s_website_form_dnone:has(input[name="${fieldName}"])`).remove();if(value){const hiddenField=qweb.render('website.form_field_hidden',{field:{name:fieldName,value:value,},});this.$target.find('.s_website_form_submit').before(hiddenField);}},_buildInput:function(field){const inputEl=document.createElement('we-input');inputEl.dataset.noPreview='true';inputEl.dataset.fieldName=field.name;inputEl.dataset.addActionField='';inputEl.setAttribute('string',field.string);inputEl.classList.add('o_we_large');return inputEl;},_buildSelect:function(field){const selectEl=document.createElement('we-select');selectEl.dataset.noPreview='true';selectEl.dataset.fieldName=field.name;selectEl.dataset.isSelect='true';selectEl.setAttribute('string',field.string);if(!field.required){const noneButton=document.createElement('we-button');noneButton.textContent='None';noneButton.dataset.addActionField=0;selectEl.append(noneButton);}
field.records.forEach(el=>{const button=document.createElement('we-button');button.textContent=el.display_name;button.dataset.addActionField=el.id;selectEl.append(button);});if(field.createAction){return this._addCreateButton(selectEl,field.createAction);}
return selectEl;},_addCreateButton:function(element,action){const linkButtonEl=document.createElement('we-button');linkButtonEl.title=_t("Create new");linkButtonEl.dataset.noPreview='true';linkButtonEl.dataset.promptSaveRedirect=action;linkButtonEl.classList.add('fa','fa-fw','fa-plus');const projectRowEl=document.createElement('we-row');projectRowEl.append(element);projectRowEl.append(linkButtonEl);return projectRowEl;},_applyFormModel:async function(modelId){let oldFormInfo;if(modelId){const oldFormKey=this.activeForm.website_form_key;if(oldFormKey){oldFormInfo=FormEditorRegistry.get(oldFormKey);}
this.$target.find('.s_website_form_field').remove();this.activeForm=_.findWhere(this.models,{id:modelId});}
const formKey=this.activeForm.website_form_key;const formInfo=FormEditorRegistry.get(formKey);if(!this.$target[0].dataset.successMode){this.$target[0].dataset.successMode='redirect';}
if(this.$target[0].dataset.successMode==='redirect'){const currentSuccessPage=this.$target[0].dataset.successPage;if(formInfo&&formInfo.successPage){this.$target[0].dataset.successPage=formInfo.successPage;}else if(!oldFormInfo||(oldFormInfo!==formInfo&&oldFormInfo.successPage&&currentSuccessPage===oldFormInfo.successPage)){this.$target[0].dataset.successPage='/contactus-thank-you';}}
this.$target[0].dataset.model_name=this.activeForm.model;if(formInfo){const formatInfo=this._getDefaultFormat();await formInfo.formFields.forEach(async field=>{field.formatInfo=formatInfo;await this._fetchFieldRecords(field);this.$target.find('.s_website_form_submit, .s_website_form_recaptcha').first().before(this._renderField(field));});}},_setLabelsMark:function(){this.$target[0].querySelectorAll('.s_website_form_mark').forEach(el=>el.remove());const mark=this._getMark();if(!mark){return;}
let fieldsToMark=[];const requiredSelector='.s_website_form_model_required, .s_website_form_required';const fields=Array.from(this.$target[0].querySelectorAll('.s_website_form_field'));if(this._isRequiredMark()){fieldsToMark=fields.filter(el=>el.matches(requiredSelector));}else if(this._isOptionalMark()){fieldsToMark=fields.filter(el=>!el.matches(requiredSelector));}
fieldsToMark.forEach(field=>{let span=document.createElement('span');span.classList.add('s_website_form_mark');span.textContent=` ${mark}`;field.querySelector('.s_website_form_label').appendChild(span);});},_redirectToAction:function(action){window.location.replace(`/web#action=${action}`);},_onToggleEndMessageClick:function(){this.showEndMessage=!this.showEndMessage;this.updateUIEndMessage();this.trigger_up('activate_snippet',{$snippet:this.showEndMessage?this.$message:this.$target,});},});const authorizedFieldsCache={};options.registry.WebsiteFieldEditor=FieldEditor.extend({init:function(){this._super.apply(this,arguments);this.rerender=true;},willStart:async function(){const _super=this._super.bind(this);const model=this.formEl.dataset.model_name;let getFields;if(model in authorizedFieldsCache){getFields=authorizedFieldsCache[model];}else{getFields=this._rpc({model:"ir.model",method:"get_authorized_fields",args:[model],});authorizedFieldsCache[model]=getFields;}
this.existingFields=await getFields.then(fields=>{this.fields=_.each(fields,function(field,fieldName){field.name=fieldName;field.domain=field.domain||[];});return Object.keys(fields).map(key=>{const field=fields[key];const button=document.createElement('we-button');button.textContent=field.string;button.dataset.existingField=field.name;return button;}).sort((a,b)=>(a.textContent>b.textContent)?1:(a.textContent<b.textContent)?-1:0);});return _super(...arguments);},start:async function(){const _super=this._super.bind(this);const select=this._getSelect();if(select){const field=this._getActiveField();await this._replaceField(field);}
return _super(...arguments);},cleanForSave:function(){this.$target[0].querySelectorAll('#editable_select').forEach(el=>el.remove());const select=this._getSelect();if(select){select.style.display='';}},updateUI:async function(){if(this.rerender){this.rerender=false;await this._rerenderXML();return;}
await this._super.apply(this,arguments);},onFocus:function(){this.rerender=true;},onClone(){const field=this._getActiveField();delete field.id;const fieldEl=this._renderField(field);this._replaceFieldElement(fieldEl);},onRemove(){const fieldName=this.$target[0].querySelector('.s_website_form_input').name;const isMultipleField=this.formEl.querySelectorAll(`.s_website_form_input[name="${fieldName}"]`).length>1;if(isMultipleField){return;}
const dependentFieldContainerEl=this.formEl.querySelectorAll(`[data-visibility-dependency="${fieldName}"]`);for(const fieldContainerEl of dependentFieldContainerEl){this._deleteConditionalVisibility(fieldContainerEl);}},toggleDescription:async function(previewMode,value,params){const field=this._getActiveField();field.description=!!value;await this._replaceField(field);},customField:async function(previewMode,value,params){if(!value){return;}
const oldLabelText=this.$target[0].querySelector('.s_website_form_label_content').textContent;const field=this._getCustomField(value,oldLabelText);this._setActiveProperties(field);await this._replaceField(field);this.rerender=true;},existingField:async function(previewMode,value,params){if(!value){return;}
const field=Object.assign({},this.fields[value]);this._setActiveProperties(field);await this._replaceField(field);this.rerender=true;},setLabelText:function(previewMode,value,params){this.$target.find('.s_website_form_label_content').text(value);if(this._isFieldCustom()){const multiple=this.$target[0].querySelector('.s_website_form_multiple');if(multiple){multiple.dataset.name=value;}
const inputEls=this.$target[0].querySelectorAll('.s_website_form_input');const previousInputName=inputEls[0].name;inputEls.forEach(el=>el.name=value);const dependentEls=this.formEl.querySelectorAll(`.s_website_form_field[data-visibility-dependency="${previousInputName}"]`);for(const dependentEl of dependentEls){dependentEl.dataset.visibilityDependency=value;}}},selectLabelPosition:async function(previewMode,value,params){const field=this._getActiveField();field.formatInfo.labelPosition=value;await this._replaceField(field);},selectType:async function(previewMode,value,params){const field=this._getActiveField();field.type=value;await this._replaceField(field);},selectTextareaValue:function(previewMode,value,params){this.$target[0].textContent=value;this.$target[0].value=value;},selectValueProperty:function(previewMode,value,params){this.$target[0].value=value?moment.unix(value).format(params.format):'';},multiCheckboxDisplay:function(previewMode,value,params){const target=this._getMultipleInputs();target.querySelectorAll('.checkbox, .radio').forEach(el=>{if(value==='horizontal'){el.classList.add('col-lg-4','col-md-6');}else{el.classList.remove('col-lg-4','col-md-6');}});target.dataset.display=value;},toggleRequired:function(previewMode,value,params){const isRequired=this.$target[0].classList.contains(params.activeValue);this.$target[0].classList.toggle(params.activeValue,!isRequired);this.$target[0].querySelectorAll('input, select, textarea').forEach(el=>el.toggleAttribute('required',!isRequired));this.trigger_up('option_update',{optionName:'WebsiteFormEditor',name:'field_mark',});},renderListItems:async function(previewMode,value,params){const valueList=JSON.parse(value);const newValuesText=valueList.map(value=>value.name);const inputEls=this.$target[0].querySelectorAll('.s_website_form_input, option');const inputName=this.$target[0].querySelector('.s_website_form_input').name;for(let i=0;i<inputEls.length;i++){const input=inputEls[i];if(newValuesText[i]&&input.value&&!newValuesText.includes(input.value)){for(const dependentEl of this.formEl.querySelectorAll(`[data-visibility-condition="${input.value}"][data-visibility-dependency="${inputName}"]`)){dependentEl.dataset.visibilityCondition=newValuesText[i];}
break;}}
const field=this._getActiveField(true);field.records=valueList;await this._replaceField(field);},setVisibility(previewMode,widgetValue,params){if(widgetValue==='conditional'){const firstInputOfForm=this.formEl.querySelector('.s_website_form_field:not(.s_website_form_dnone) input');this._setVisibilityDependency(firstInputOfForm.name);return;}
this._deleteConditionalVisibility(this.$target[0]);},setVisibilityDependency(previewMode,widgetValue,params){this._setVisibilityDependency(widgetValue);},_computeWidgetState:function(methodName,params){switch(methodName){case'toggleDescription':{const description=this.$target[0].querySelector('.s_website_form_field_description');return!!description;}
case'customField':return this._isFieldCustom()?this._getFieldType():'';case'existingField':return this._isFieldCustom()?'':this._getFieldName();case'setLabelText':return this.$target.find('.s_website_form_label_content').text();case'selectLabelPosition':return this._getLabelPosition();case'selectType':return this._getFieldType();case'selectTextareaValue':return this.$target[0].textContent;case'selectValueProperty':return this.$target[0].getAttribute('value')||'';case'multiCheckboxDisplay':{const target=this._getMultipleInputs();return target?target.dataset.display:'';}
case'toggleRequired':return this.$target[0].classList.contains(params.activeValue)?params.activeValue:'false';case'renderListItems':return JSON.stringify(this._getListItems());case'setVisibilityDependency':return this.$target[0].dataset.visibilityDependency||'';}
return this._super(...arguments);},_computeWidgetVisibility:function(widgetName,params){const dependencyEl=this._getDependencyEl();switch(widgetName){case'hidden_condition_time_comparators_opt':return dependencyEl&&dependencyEl.dataset.target;case'hidden_condition_date_between':return dependencyEl&&dependencyEl.dataset.target&&dependencyEl.dataset.target.includes('#datepicker')&&['between','!between'].includes(this.$target[0].getAttribute('data-visibility-comparator'));case'hidden_condition_datetime_between':return dependencyEl&&dependencyEl.dataset.target&&dependencyEl.dataset.target.includes('#datetimepicker')&&['between','!between'].includes(this.$target[0].dataset.visibilityComparator);case'hidden_condition_additional_datetime':return dependencyEl&&dependencyEl.dataset.target&&dependencyEl.dataset.target.includes('#datetimepicker')&&!['set','!set'].includes(this.$target[0].dataset.visibilityComparator);case'hidden_condition_additional_date':return dependencyEl&&dependencyEl.dataset.target&&dependencyEl.dataset.target.includes('#datepicker')&&!['set','!set'].includes(this.$target[0].dataset.visibilityComparator);case'hidden_condition_additional_text':if(!this.$target[0].classList.contains('s_website_form_field_hidden_if')||(dependencyEl&&(['checkbox','radio'].includes(dependencyEl.type)||dependencyEl.nodeName==='SELECT'))){return false;}
if(!dependencyEl){return true;}
if(dependencyEl.dataset.target&&dependencyEl.dataset.target.includes('#date')){return false;}
return(['text','email','tel','url','search','password','number'].includes(dependencyEl.type)||dependencyEl.nodeName==='TEXTAREA')&&!['set','!set'].includes(this.$target[0].dataset.visibilityComparator);case'hidden_condition_no_text_opt':return dependencyEl&&(dependencyEl.type==='checkbox'||dependencyEl.type==='radio'||dependencyEl.nodeName==='SELECT');case'hidden_condition_num_opt':return dependencyEl&&dependencyEl.type==='number';case'hidden_condition_text_opt':if(!this.$target[0].classList.contains('s_website_form_field_hidden_if')||(dependencyEl&&dependencyEl.dataset.target&&dependencyEl.dataset.target.includes('#date'))){return false;}
return!dependencyEl||(['text','email','tel','url','search','password'].includes(dependencyEl.type)||dependencyEl.nodeName==='TEXTAREA');case'hidden_condition_date_opt':return dependencyEl&&dependencyEl.dataset.target&&dependencyEl.dataset.target.includes('#datepicker');case'hidden_condition_datetime_opt':return dependencyEl&&dependencyEl.dataset.target&&dependencyEl.dataset.target.includes('#datetimepicker');case'hidden_condition_opt':return this.$target[0].classList.contains('s_website_form_field_hidden_if');case'char_input_type_opt':return!this.$target[0].classList.contains('s_website_form_custom')&&['char','email','tel','url'].includes(this.$target[0].dataset.type);case'multi_check_display_opt':return!!this._getMultipleInputs();case'required_opt':case'hidden_opt':case'type_opt':return!this.$target[0].classList.contains('s_website_form_model_required');}
return this._super(...arguments);},_deleteConditionalVisibility(fieldEl){for(const name of this.VISIBILITY_DATASET){delete fieldEl.dataset[name];}
fieldEl.classList.remove('s_website_form_field_hidden_if','d-none');},_getDependencyEl(){const dependencyName=this.$target[0].dataset.visibilityDependency;return this.formEl.querySelector(`.s_website_form_input[name="${dependencyName}"]`);},_renderCustomXML:async function(uiFragment){const selectDependencyEl=uiFragment.querySelector('we-select[data-name="hidden_condition_opt"]');if(selectDependencyEl){const existingDependencyNames=[];for(const el of this.formEl.querySelectorAll('.s_website_form_field:not(.s_website_form_dnone)')){const inputEl=el.querySelector('.s_website_form_input');if(el.querySelector('.s_website_form_label_content')&&inputEl&&inputEl.name&&inputEl.name!==this.$target[0].querySelector('.s_website_form_input').name&&!existingDependencyNames.includes(inputEl.name)){const button=document.createElement('we-button');button.textContent=el.querySelector('.s_website_form_label_content').textContent;button.dataset.setVisibilityDependency=inputEl.name;selectDependencyEl.append(button);existingDependencyNames.push(inputEl.name);}}
const comparator=this.$target[0].dataset.visibilityComparator;const dependencyEl=this._getDependencyEl();if(dependencyEl){if((['radio','checkbox'].includes(dependencyEl.type)||dependencyEl.nodeName==='SELECT')){const selectOptEl=uiFragment.querySelectorAll('we-select[data-name="hidden_condition_no_text_opt"]')[1];const inputContainerEl=this.$target[0];const dependencyEl=this._getDependencyEl();if(dependencyEl.nodeName==='SELECT'){for(const option of dependencyEl.querySelectorAll('option')){const button=document.createElement('we-button');button.textContent=option.value;button.dataset.selectDataAttribute=option.value;selectOptEl.append(button);}
if(!inputContainerEl.dataset.visibilityCondition){inputContainerEl.dataset.visibilityCondition=dependencyEl.querySelector('option').value;}}else{const dependencyContainerEl=dependencyEl.closest('.s_website_form_field');const inputsInDependencyContainer=dependencyContainerEl.querySelectorAll('.s_website_form_input');for(const el of inputsInDependencyContainer){const button=document.createElement('we-button');button.textContent=el.value;button.dataset.selectDataAttribute=el.value;selectOptEl.append(button);}
if(!inputContainerEl.dataset.visibilityCondition){inputContainerEl.dataset.visibilityCondition=inputsInDependencyContainer[0].value;}}
if(!inputContainerEl.dataset.visibilityComparator){inputContainerEl.dataset.visibilityComparator='selected';}
this.rerender=comparator?this.rerender:true;}
if(!comparator){if(dependencyEl.dataset.target){this.$target[0].dataset.visibilityComparator='after';}else if(['text','email','tel','url','search','password','number'].includes(dependencyEl.type)||dependencyEl.nodeName==='TEXTAREA'){this.$target[0].dataset.visibilityComparator='equal';}}}}
const selectEl=uiFragment.querySelector('we-select[data-name="type_opt"]');const currentFieldName=this._getFieldName();const fieldsInForm=Array.from(this.formEl.querySelectorAll('.s_website_form_field:not(.s_website_form_custom) .s_website_form_input')).map(el=>el.name).filter(el=>el!==currentFieldName);const availableFields=this.existingFields.filter(el=>!fieldsInForm.includes(el.dataset.existingField));if(availableFields.length){const title=document.createElement('we-title');title.textContent='Existing fields';availableFields.unshift(title);availableFields.forEach(option=>selectEl.append(option.cloneNode(true)));}
const select=this._getSelect();const multipleInputs=this._getMultipleInputs();if(!select&&!multipleInputs){return;}
const field=Object.assign({},this.fields[this._getFieldName()]);const type=this._getFieldType();const list=document.createElement('we-list');const optionText=select?'Option':type==='selection'?'Radio':'Checkbox';list.setAttribute('string',`${optionText} List`);list.dataset.addItemTitle=_.str.sprintf(_t("Add new %s"),optionText);list.dataset.renderListItems='';list.dataset.hasDefault=['one2many','many2many'].includes(type)?'multiple':'unique';const defaults=[...this.$target[0].querySelectorAll('[checked], [selected]')].map(el=>{const idInt=parseInt(el.value);return isNaN(idInt)?el.value:idInt;});list.dataset.defaults=JSON.stringify(defaults);if(!this._isFieldCustom()){await this._fetchFieldRecords(field);list.dataset.availableRecords=JSON.stringify(field.records);}
if(selectDependencyEl){uiFragment.insertBefore(list,uiFragment.querySelector('we-select[string="Visibility"]'));}else{uiFragment.appendChild(list);}},_replaceField:async function(field){await this._fetchFieldRecords(field);const activeField=this._getActiveField();if(activeField.type!==field.type){field.value='';}
const fieldEl=this._renderField(field);this._replaceFieldElement(fieldEl);},_replaceFieldElement(fieldEl){const hasConditionalVisibility=this.$target[0].classList.contains('s_website_form_field_hidden_if');const previousName=this.$target[0].querySelector('.s_website_form_input').name;[...this.$target[0].childNodes].forEach(node=>node.remove());[...fieldEl.childNodes].forEach(node=>this.$target[0].appendChild(node));[...fieldEl.attributes].forEach(el=>this.$target[0].removeAttribute(el.nodeName));[...fieldEl.attributes].forEach(el=>this.$target[0].setAttribute(el.nodeName,el.nodeValue));if(hasConditionalVisibility){this.$target[0].classList.add('s_website_form_field_hidden_if','d-none');}
const dependentFieldEls=this.formEl.querySelectorAll(`.s_website_form_field[data-visibility-dependency="${previousName}"]`);const newName=this.$target[0].querySelector('.s_website_form_input').name;if(previousName!==newName&&dependentFieldEls){for(const fieldEl of dependentFieldEls){this._deleteConditionalVisibility(fieldEl);}}},_setVisibilityDependency(value){delete this.$target[0].dataset.visibilityCondition;delete this.$target[0].dataset.visibilityComparator;const previousDependency=this._getDependencyEl();if(this.formEl.querySelector(`.s_website_form_input[name="${value}"]`).type!==(previousDependency&&previousDependency.type)){this.rerender=true;}
this.$target[0].dataset.visibilityDependency=value;},_getListItems:function(){const select=this._getSelect();const multipleInputs=this._getMultipleInputs();let options=[];if(select){options=[...select.querySelectorAll('option')];}else if(multipleInputs){options=[...multipleInputs.querySelectorAll('.checkbox input, .radio input')];}
return options.map(opt=>{const id=parseInt(opt.value);const name=select?opt:opt.nextElementSibling;return{id:isNaN(id)?opt.value:id,display_name:name.textContent.trim(),selected:select?opt.selected:opt.checked,};});},_getSelect:function(){return this.$target[0].querySelector('select');},});options.registry.AddFieldForm=FormEditor.extend({isTopOption:true,isTopFirstOption:true,addField:async function(previewMode,value,params){const field=this._getCustomField('char','Custom Text');field.formatInfo=this._getDefaultFormat();const fieldEl=this._renderField(field);this.$target.find('.s_website_form_submit, .s_website_form_recaptcha').first().before(fieldEl);this.trigger_up('activate_snippet',{$snippet:$(fieldEl),});},});options.registry.AddField=FieldEditor.extend({isTopOption:true,isTopFirstOption:true,addField:async function(previewMode,value,params){this.trigger_up('option_update',{optionName:'WebsiteFormEditor',name:'add_field',data:{formatInfo:this._getFieldFormat(),$target:this.$target,},});},});const DisableOverlayButtonOption=options.Class.extend({disableButton:function(buttonName,message){const className='oe_snippet_'+buttonName;this.$overlay.add(this.$overlay.data('$optionsSection')).on('click','.'+className,this.preventButton);const $button=this.$overlay.add(this.$overlay.data('$optionsSection')).find('.'+className);$button.attr('title',message).tooltip({delay:0});$button.removeClass(className);},preventButton:function(event){event.preventDefault();event.stopImmediatePropagation();}});options.registry.WebsiteFormFieldModel=DisableOverlayButtonOption.extend({start:function(){this.disableButton('clone',_t('You can\'t duplicate a model field.'));return this._super.apply(this,arguments);}});options.registry.WebsiteFormFieldRequired=DisableOverlayButtonOption.extend({start:function(){this.disableButton('remove',_t('You can\'t remove a field that is required by the model itself.'));return this._super.apply(this,arguments);}});options.registry.WebsiteFormSubmitRequired=DisableOverlayButtonOption.extend({start:function(){this.disableButton('remove',_t('You can\'t remove the submit button of the form'));this.disableButton('clone',_t('You can\'t duplicate the submit button of the form.'));return this._super.apply(this,arguments);}});options.registry.MobileVisibility.include({async _computeVisibility(){return await this._super(...arguments)&&!this.$target.hasClass('s_website_form_field_hidden');},});});;

/* /website/static/src/snippets/s_searchbar/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('@website/snippets/s_searchbar/options',async function(require){'use strict';let __exports={};const options=require('web_editor.snippets.options');options.registry.SearchBar=options.Class.extend({setSearchType:function(previewMode,widgetValue,params){const form=this.$target.parents('form');form.attr('action',params.formAction);if(!previewMode){this.trigger_up('snippet_edition_request',{exec:()=>{const widget=this._requestUserValueWidgets('order_opt')[0];const orderBy=widget.getValue("selectDataAttribute");const order=widget.$el.find("we-button[data-select-data-attribute='"+orderBy+"']")[0];if(order.classList.contains("d-none")){const defaultOrder=widget.$el.find("we-button[data-name='order_name_asc_opt']")[0];defaultOrder.click();defaultOrder.click();}}});}},setOrderBy:function(previewMode,widgetValue,params){const form=this.$target.parents('form');form.find(".o_search_order_by").attr("value",widgetValue);},});__exports[Symbol.for("default")]={SearchBar:options.registry.SearchBar,};return __exports;});;

/* /website/static/src/js/editor/wysiwyg.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.wysiwyg',function(require){'use strict';var Wysiwyg=require('web_editor.wysiwyg');var snippetsEditor=require('web_editor.snippet.editor');const weWidgets=require('wysiwyg.widgets');function toggleDropdown($toggles,show){return Promise.all(_.map($toggles,toggle=>{var $toggle=$(toggle);var $dropdown=$toggle.parent();var shown=$dropdown.hasClass('show');if(shown===show){return;}
var toShow=!shown;return new Promise(resolve=>{$dropdown.one(toShow?'shown.bs.dropdown':'hidden.bs.dropdown',()=>resolve());$toggle.dropdown(toShow?'show':'hide');});})).then(()=>$toggles);}
Wysiwyg.include({start:function(){this.options.toolbarHandler=$('#web_editor-top-edit');var $dropdownMenuToggles=this.$('.o_mega_menu_toggle, #top_menu_container .dropdown-toggle');$dropdownMenuToggles.removeAttr('data-toggle').dropdown('dispose');$dropdownMenuToggles.on('click.wysiwyg_megamenu',ev=>{this.odooEditor.observerUnactive();var $toggle=$(ev.currentTarget);var dispose=($els=>$els.dropdown('dispose'));toggleDropdown($dropdownMenuToggles.not($toggle),false).then(dispose);toggleDropdown($toggle).then(dispose).then(()=>this._toggleMegaMenu($toggle[0])).then(()=>this.odooEditor.observerActive());});for(const el of this.$('.oe_structure')){if(!el.innerHTML.trim()){$(el).empty();}}
return this._super.apply(this,arguments);},_saveViewBlocks:async function(){await this._super.apply(this,arguments);if(this.isDirty()){return this._restoreMegaMenus();}},destroy:function(){this._restoreMegaMenus();this._super.apply(this,arguments);},_saveCoverProperties:function($elementToSave){var el=$elementToSave.closest('.o_record_cover_container')[0];if(!el){return;}
var resModel=el.dataset.resModel;var resID=parseInt(el.dataset.resId);if(!resModel||!resID){throw new Error('There should be a model and id associated to the cover');}
this.__savedCovers=this.__savedCovers||{};this.__savedCovers[resModel]=this.__savedCovers[resModel]||[];if(this.__savedCovers[resModel].includes(resID)){return;}
this.__savedCovers[resModel].push(resID);var cssBgImage=$(el.querySelector('.o_record_cover_image')).css('background-image');var coverProps={'background-image':cssBgImage.replace(/"/g,'').replace(window.location.protocol+"//"+window.location.host,''),'background_color_class':el.dataset.bgColorClass,'background_color_style':el.dataset.bgColorStyle,'opacity':el.dataset.filterValue,'resize_class':el.dataset.coverClass,'text_align_class':el.dataset.textAlignClass,};return this._rpc({model:resModel,method:'write',args:[resID,{'cover_properties':JSON.stringify(coverProps)}],});},_saveElement:async function($el,context,withLang){var promises=[];await this._super.apply(this,arguments);if($el.data('oe-field')==='mega_menu_content'){var classes=_.without($el.attr('class').split(' '),'dropdown-menu','o_mega_menu','show');promises.push(this._rpc({model:'website.menu',method:'write',args:[[parseInt($el.data('oe-id'))],{'mega_menu_classes':classes.join(' '),},],}));}
var prom=this._saveCoverProperties($el);if(prom){promises.push(prom);}
return Promise.all(promises);},_restoreMegaMenus:function(){var $megaMenuToggles=this.$('.o_mega_menu_toggle');$megaMenuToggles.off('.wysiwyg_megamenu').attr('data-toggle','dropdown').dropdown({});return toggleDropdown($megaMenuToggles,false);},_toggleMegaMenu:function(toggleEl){const megaMenuEl=toggleEl.parentElement.querySelector('.o_mega_menu');if(!megaMenuEl||!megaMenuEl.classList.contains('show')){return this.snippetsMenu.activateSnippet(false);}
megaMenuEl.classList.add('o_no_parent_editor');return this.snippetsMenu.activateSnippet($(megaMenuEl));},});snippetsEditor.SnippetsMenu.include({init:function(){this._super(...arguments);this._notActivableElementsSelector+=', .o_mega_menu_toggle';},_insertDropzone:function($hook){var $hookParent=$hook.parent();var $dropzone=this._super(...arguments);$dropzone.attr('data-editor-message',$hookParent.attr('data-editor-message'));$dropzone.attr('data-editor-sub-message',$hookParent.attr('data-editor-sub-message'));return $dropzone;},});});;

/* /website/static/src/js/editor/widget_link.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.editor.link',function(require){'use strict';var weWidgets=require('wysiwyg.widgets');var wUtils=require('website.utils');weWidgets.LinkTools.include({xmlDependencies:(weWidgets.LinkTools.prototype.xmlDependencies||[]).concat(['/website/static/src/xml/website.editor.xml']),events:_.extend({},weWidgets.LinkTools.prototype.events||{},{'click we-selection-items[name="link_anchor"] we-button':'_onAnchorChange','input input[name="url"]':'_onURLInput',}),custom_events:_.extend({},weWidgets.LinkTools.prototype.custom_events||{},{website_url_chosen:'_onAutocompleteClose',}),LINK_DEBOUNCE:1000,init:function(){this._super.apply(this,arguments);this._adaptPageAnchor=_.debounce(this._adaptPageAnchor,this.LINK_DEBOUNCE);},start:async function(){var def=await this._super.apply(this,arguments);const options={position:{collision:'flip fit',},classes:{"ui-autocomplete":'o_website_ui_autocomplete'},}
wUtils.autocompleteWithPages(this,this.$('input[name="url"]'),options);this._adaptPageAnchor();return def;},_adaptPageAnchor:function(){const urlInputValue=this.$('input[name="url"]').val();const $pageAnchor=this.$('.o_link_dialog_page_anchor');const isFromWebsite=urlInputValue[0]==='/';const $selectMenu=this.$('we-selection-items[name="link_anchor"]');if($selectMenu.data("anchor-for")!==urlInputValue){$pageAnchor.toggleClass('d-none',!isFromWebsite);$selectMenu.empty();const always=()=>$pageAnchor.find('we-toggler').text('\u00A0');wUtils.loadAnchors(urlInputValue).then(anchors=>{for(const anchor of anchors){const $option=$('<we-button class="dropdown-item">');$option.text(anchor);$option.data('value',anchor);$selectMenu.append($option);}
always();}).guardedCatch(always);}
$selectMenu.data("anchor-for",urlInputValue);},_onAutocompleteClose:function(){this._onURLInput();},_onAnchorChange:function(){const anchorValue=this.$('[name="link_anchor"] we-button.active').data('value');const $urlInput=this.$('[name="url"]');let urlInputValue=$urlInput.val();if(urlInputValue.indexOf('#')>-1){urlInputValue=urlInputValue.substr(0,urlInputValue.indexOf('#'));}
$urlInput.val(urlInputValue+anchorValue);},_onURLInput:function(){this._super.apply(this,arguments);this._adaptPageAnchor();},});});;

/* /website/static/src/js/widgets/media.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('website.widgets.media',function(require){'use strict';const{ImageWidget}=require('wysiwyg.widgets.media');ImageWidget.include({_getAttachmentsDomain(){const domain=this._super(...arguments);domain.push('|',['url','=',false],'!',['url','=like','/web/image/website.%']);domain.push(['key','=',false]);return domain;}});});;

/* /website/static/src/js/widgets/link_popover_widget.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('@website/js/widgets/link_popover_widget',async function(require){'use strict';let __exports={};const contentMenu=require('website.contentMenu');const weWidgets=require('wysiwyg.widgets');const{_t}=require('web.core');weWidgets.LinkPopoverWidget.include({start(){if(this.target.closest('.o_mega_menu')){let timeoutID=undefined;this.$target.on('keydown.link_popover',()=>{this.$target.popover('hide');clearTimeout(timeoutID);timeoutID=setTimeout(()=>this.$target.popover('show'),1500);});}
return this._super(...arguments);},});const NavbarLinkPopoverWidget=weWidgets.LinkPopoverWidget.extend({events:_.extend({},weWidgets.LinkPopoverWidget.prototype.events,{'click .js_edit_menu':'_onEditMenuClick',}),start(){const $anchor=$('<a/>',{href:'#',class:'ml-2 js_edit_menu',title:_t('Edit Menu'),'data-placement':'top','data-toggle':'tooltip',}).append($('<i/>',{class:'fa fa-sitemap text-secondary'}));this.$('.o_we_remove_link').replaceWith($anchor);return this._super(...arguments);},_onEditLinkClick(ev){var self=this;var $menu=this.$target.find('[data-oe-id]');var dialog=new contentMenu.MenuEntryDialog(this,{},null,{name:$menu.text(),url:$menu.parent().attr('href'),});dialog.on('save',this,link=>{let websiteId;this.trigger_up('context_get',{callback:function(ctx){websiteId=ctx['website_id'];},});const data={id:$menu.data('oe-id'),name:link.content,url:link.url,};return this._rpc({model:'website.menu',method:'save',args:[websiteId,{'data':[data]}],}).then(function(){self.options.wysiwyg.odooEditor.observerUnactive();self.$target.attr('href',link.url);$menu.text(link.content);self.options.wysiwyg.odooEditor.observerActive();});});dialog.open();},_onEditMenuClick(ev){this.trigger_up('action_demand',{actionName:'edit_menu',params:[()=>{const prom=new Promise((resolve,reject)=>{this.trigger_up('request_save',{onSuccess:resolve,onFailure:reject,});});return prom;},],});},});NavbarLinkPopoverWidget.createFor=weWidgets.LinkPopoverWidget.createFor;__exports[Symbol.for("default")]=NavbarLinkPopoverWidget;return __exports;});;

/* /website_payment/static/src/snippets/s_donation/options.js defined in bundle 'website.assets_wysiwyg' */
odoo.define('@website_payment/snippets/s_donation/options',async function(require){'use strict';let __exports={};const{_t,qweb}=require('web.core');const options=require('web_editor.snippets.options');options.registry.Donation=options.Class.extend({xmlDependencies:['/website_payment/static/src/snippets/s_donation/000.xml'],start(){this.defaultDescription=_t("Add a description here");return this._super(...arguments);},onBuilt(){this._rebuildPrefilledOptions();return this._super(...arguments);},cleanForSave(){if(!this.$target[0].dataset.descriptions){this._updateDescriptions();}},async updateUI(){await this._super(...arguments);this._buildDescriptionsList();},displayOptions(previewMode,widgetValue,params){this.$target[0].dataset.displayOptions=widgetValue;if(!widgetValue&&this.$target[0].dataset.customAmount==="slider"){this.$target[0].dataset.customAmount="freeAmount";}else if(widgetValue&&!this.$target[0].dataset.prefilledOptions){this.$target[0].dataset.customAmount="slider";}
this._rebuildPrefilledOptions();},togglePrefilledOptions(previewMode,widgetValue,params){this.$target[0].dataset.prefilledOptions=widgetValue;this.$el.find('.o_we_prefilled_options_list').toggleClass('d-none',!widgetValue);if(!widgetValue&&this.$target[0].dataset.displayOptions){this.$target[0].dataset.customAmount="slider";}
this._rebuildPrefilledOptions();},toggleOptionDescription(previewMode,widgetValue,params){this.$target[0].dataset.descriptions=widgetValue;this.renderListItems(false,this._buildPrefilledOptionsList());},selectAmountInput(previewMode,widgetValue,params){this.$target[0].dataset.customAmount=widgetValue;this._rebuildPrefilledOptions();},renderListItems(previewMode,value,params){const valueList=JSON.parse(value);const donationAmounts=[];delete this.$target[0].dataset.donationAmounts;_.each(valueList,value=>{donationAmounts.push(value.display_name);});this.$target[0].dataset.donationAmounts=JSON.stringify(donationAmounts);this._rebuildPrefilledOptions();},listChanged(previewMode,value,params){this._updateDescriptions();this._rebuildPrefilledOptions();},setMinimumAmount(previewMode,widgetValue,params){this.$target[0].dataset.minimumAmount=widgetValue;const $rangeSlider=this.$('#s_donation_range_slider');const $amountInput=this.$('#s_donation_amount_input');if($rangeSlider.length){$rangeSlider[0].min=widgetValue;}else if($amountInput.length){$amountInput[0].min=widgetValue;}},setMaximumAmount(previewMode,widgetValue,params){this.$target[0].dataset.maximumAmount=widgetValue;const $rangeSlider=this.$('#s_donation_range_slider');const $amountInput=this.$('#s_donation_amount_input');if($rangeSlider.length){$rangeSlider[0].max=widgetValue;}else if($amountInput.length){$amountInput[0].max=widgetValue;}},setSliderStep(previewMode,widgetValue,params){this.$target[0].dataset.sliderStep=widgetValue;const $rangeSlider=this.$('#s_donation_range_slider');if($rangeSlider.length){$rangeSlider[0].step=widgetValue;}},_computeWidgetState(methodName,params){switch(methodName){case'displayOptions':{return this.$target[0].dataset.displayOptions;}
case'togglePrefilledOptions':{return this.$target[0].dataset.prefilledOptions;}
case'toggleOptionDescription':{return this.$target[0].dataset.descriptions;}
case'selectAmountInput':{return this.$target[0].dataset.customAmount;}
case'renderListItems':{return this._buildPrefilledOptionsList();}
case'setMinimumAmount':{return this.$target[0].dataset.minimumAmount;}
case'setMaximumAmount':{return this.$target[0].dataset.maximumAmount;}
case'setSliderStep':{return this.$target[0].dataset.sliderStep;}}
return this._super(...arguments);},async _computeWidgetVisibility(widgetName,params){if(widgetName==='free_amount_opt'){return!(this.$target[0].dataset.displayOptions&&!this.$target[0].dataset.prefilledOptions);}
return this._super(...arguments);},_renderCustomXML(uiFragment){const list=document.createElement('we-list');list.dataset.dependencies="pre_filled_opt";list.dataset.addItemTitle=_t("Add new pre-filled option");list.dataset.renderListItems='';list.dataset.unsortable='true';list.dataset.inputType='number';list.dataset.defaultValue=50;list.dataset.listChanged='';$(uiFragment).find('we-checkbox[data-name="pre_filled_opt"]').after(list);},_buildPrefilledOptionsList(){const amounts=JSON.parse(this.$target[0].dataset.donationAmounts);let valueList=amounts.map(amount=>{return{id:amount,display_name:amount,};});return JSON.stringify(valueList);},_buildDescriptionsList(){if(this.$target[0].dataset.descriptions){const $descriptions=this.$target.find('#s_donation_description_inputs > input');const $tableEl=this.$el.find('we-list table');_.each($tableEl.find('tr'),(trEl,i)=>{const $inputAmount=$(trEl).find('td').first();$inputAmount.addClass('w-25');const tdEl=document.createElement('td');const inputEl=document.createElement('input');inputEl.type='text';inputEl.value=$descriptions[i]?$descriptions[i].value:this.defaultDescription;tdEl.classList.add('w-auto');tdEl.appendChild(inputEl);$(tdEl).insertAfter($inputAmount);});this._updateDescriptions();}},_updateDescriptions(){const descriptionInputs=this.$target.find('#s_donation_description_inputs');descriptionInputs.empty();const descriptions=this.$el.find('we-list input[type=text]');_.each(descriptions,description=>{const inputEl=document.createElement('input');inputEl.type='hidden';inputEl.classList.add('o_translatable_input_hidden','d-block','mb-1','w-100');inputEl.name='donation_descriptions';inputEl.value=description.value;descriptionInputs[0].appendChild(inputEl);});},_rebuildPrefilledOptions(){const rebuild=this.$target[0].dataset.displayOptions;this.$target.find('.s_donation_prefilled_buttons').remove();const layout=this.$target[0].dataset.customAmount;const $slider=this.$target.find('.s_donation_range_slider_wrap');if(layout!=="slider"||!rebuild){$slider.remove();}
if(rebuild){if(layout==="slider"&&!$slider.length){const sliderTemplate=$(qweb.render('website_payment.donation.slider',{minimum_amount:this.$target[0].dataset.minimumAmount,maximum_amount:this.$target[0].dataset.maximumAmount,slider_step:this.$target[0].dataset.sliderStep,}));this.$target.find('.s_donation_donate_btn').before(sliderTemplate);}
const prefilledOptions=this.$target[0].dataset.prefilledOptions;let donationAmounts=0;let showDescriptions=false;if(prefilledOptions){donationAmounts=JSON.parse(this.$target[0].dataset.donationAmounts);showDescriptions=this.$target[0].dataset.descriptions;if(showDescriptions){const $descriptions=this.$target.find('#s_donation_description_inputs > input');donationAmounts=donationAmounts.map((amount,i)=>{return{value:amount,description:$descriptions[i]?$descriptions[i].value:this.defaultDescription,};});}}
const $prefilledButtons=$(qweb.render(`website_payment.donation.prefilledButtons${showDescriptions ? 'Descriptions' : ''}`,{prefilled_buttons:donationAmounts,custom_input:layout==="freeAmount",minimum_amount:this.$target[0].dataset.minimumAmount,}));this.$target.find('#s_donation_description_inputs').after($prefilledButtons);}},});__exports[Symbol.for("default")]={Donation:options.registry.Donation,};return __exports;});